

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Primeiro subplot (superior esquerdo) &#8212; Programação para Geoprocessamento</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'capitulo6';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="referencias.html" />
    <link rel="prev" title="5 A BIBLIOTECA GEOPANDAS" href="capitulo5.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/pythongeo.png" class="logo__image only-light" alt="Programação para Geoprocessamento - Home"/>
    <script>document.write(`<img src="_static/pythongeo.png" class="logo__image only-dark" alt="Programação para Geoprocessamento - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="introducao.html">1. INTRODUÇÃO</a></li>
<li class="toctree-l1"><a class="reference internal" href="capitulo2.html">2. FUNDAMENTOS DA LINGUAGEM PYTHON</a></li>
<li class="toctree-l1"><a class="reference internal" href="capitulo3.html">A BIBLIOTECA PANDAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="capitulo4.html">4. GEOPROCESSAMENTO BÁSICO COM SHAPELY E FIONA</a></li>
<li class="toctree-l1"><a class="reference internal" href="capitulo5.html">5 A BIBLIOTECA GEOPANDAS</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Primeiro subplot (superior esquerdo)</a></li>



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://alexandrogschafer.github.io/Programacao-Geoprocessamento/intro.html" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://alexandrogschafer.github.io/Programacao-Geoprocessamento/intro.html/issues/new?title=Issue%20on%20page%20%2Fcapitulo6.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/capitulo6.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Primeiro subplot (superior esquerdo)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Primeiro subplot (superior esquerdo)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#segundo-subplot-superior-direito">Segundo subplot (superior direito)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#terceiro-subplot-inferior-esquerdo">Terceiro subplot (inferior esquerdo)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quarto-subplot-inferior-direito">Quarto subplot (inferior direito)</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <ol class="arabic simple" start="6">
<li><p>VISUALIZAÇÃO DE DADOS GEOESPACIAIS NO PYTHON</p></li>
</ol>
<p>O geoprocessamento, como área que se dedica à coleta, processamento e análise de dados geoespaciais, é intrinsecamente ligado à visualização de informações. A representação gráfica desses dados não apenas facilita a compreensão de padrões e tendências espaciais, mas também serve como uma ponte entre informações complexas e a tomada de decisões informadas. Mapas, gráficos e outras representações visuais transformam conjuntos de dados brutos em insights tangíveis, permitindo que especialistas e tomadores de decisão visualizem fenômenos geográficos de maneira mais intuitiva.
Além disso, em um mundo onde a quantidade de dados geoespaciais cresce exponencialmente, a capacidade de sintetizar e apresentar esses dados de forma clara e concisa é crucial. A visualização adequada permite que os usuários identifiquem rapidamente áreas de interesse, anomalias ou padrões, otimizando processos de análise e acelerando a resposta a questões geográficas críticas. Esta síntese visual também facilita a comunicação entre diferentes públicos, desde especialistas técnicos até o público em geral, democratizando o acesso à informação geoespacial.
Por fim, a visualização de dados no geoprocessamento não se limita à simples representação gráfica. Ela também desempenha um papel vital na validação e qualidade dos dados. Através da representação visual, erros, inconsistências ou lacunas nos dados podem ser rapidamente identificados e corrigidos. Assim, a visualização atua como uma ferramenta de controle de qualidade, garantindo que as análises e decisões tomadas com base nesses dados sejam confiáveis e precisas.
Existem diversas ferramentas dedicadas à visualização de dados espaciais. Entre as mais populares estão o QGIS e o ArcGIS. No entanto, linguagens de programação, como Python e R, também oferecem bibliotecas que permitem criar visualizações espaciais complexas e personalizadas. Algumas das principais bibliotecas e ferramentas que possibilitam a visualização de dados espaciais em Python são o Geopandas, o Matplotlib (e Pyplot), o Folium e o Rasterio. Nesta seção, exploraremos algumas dessas ferramentas e bibliotecas.</p>
<p>6.1 Introdução ao Matplotlib</p>
<p>O Matplotlib é uma das principais bibliotecas de visualização de dados em Python, criada por John D. Hunter em 2003. Desde sua concepção, cresceu significativamente como um projeto de código aberto, auxiliado por uma grande comunidade de colaboradores.
A biblioteca destaca-se pela sua capacidade de gerar uma ampla variedade de gráficos, como de linha, barras, dispersão, histogramas, entre outros, e se integra com as principais estruturas de dados do Python, como listas e arrays, especialmente com a biblioteca Numpy.
Um diferencial do Matplotlib é seu alto grau de personalização. O usuário pode ajustar quase todos os aspectos de uma visualização, desde cores e estilos até a posição das legendas e dos eixos. É possível implementar a biblioteca em diferentes interfaces gráficas, servidores web e Notebooks Jupyter, conferindo grande versatilidade na criação e exportação de gráficos.
Além de suas capacidades intrínsecas, a extensibilidade do Matplotlib é evidente no surgimento de bibliotecas derivadas que oferecem funcionalidades adicionais, como o Seaborn para visualizações estatísticas e o Basemap para mapeamento geográfico. Sua adoção generalizada em diversos campos, como pesquisa acadêmica, ciência de dados e engenharia, reforça seu papel como uma ferramenta importante para análise e comunicação de dados.</p>
<p>6.1.1 Principais abordagens para a criação de gráficos no Matplotlib</p>
<p>A criação de gráficos no Matplotlib pode ser abordada de duas maneiras principais: a abordagem funcional e a abordagem orientada a objetos. Ambas permitem a criação de visualizações de alta qualidade, mas são usadas em contextos diferentes e têm diferenças em termos de flexibilidade e controle sobre os elementos do gráfico.
A abordagem Funcional é a mais simples, sendo frequentemente usada para gráficos rápidos e diretos. A interface pyplot do Matplotlib oferece uma série de funções que atuam sobre uma configuração padrão em andamento. Por exemplo, quando você chama plt.plot(…), você está modificando o gráfico atual. As funções nesta abordagem se assemelham a comandos, e a sequência em que são chamadas importa, pois alteram o estado atual do gráfico. Embora seja conveniente para gráficos simples, pode tornar-se menos intuitiva para visualizações mais complexas com múltiplos subgráficos.
A abordagem orientada a objetos (OO) no Matplotlib refere-se a uma maneira de criar e manipular gráficos usando explicitamente objetos e métodos associados a esses objetos, em vez de depender de uma interface funcional mais direta. Esta abordagem oferece um controle mais explícito e maior flexibilidade sobre a figura e os eixos do gráfico. Ao invés de depender do estado global, você trabalha diretamente com objetos específicos, como a figura e os eixos, permitindo um controle mais preciso sobre todos os aspectos da visualização. É especialmente útil para visualizações mais complexas, como aquelas com múltiplos subgráficos ou eixos. Ela é frequentemente combinada com a interface pyplot para obter a flexibilidade da programação orientada a objeto com a simplicidade das funções do pyplot.
Em resumo, enquanto a abordagem funcional é ótima para criar rapidamente visualizações simples, a abordagem orientada a objetos oferece a flexibilidade necessária para criar visualizações mais complexas e personalizadas. A escolha entre as abordagens depende do contexto e da complexidade da visualização desejada. Em nosso curso, vamos optar por trabalhar com a abordagem funcional sempre que possível.</p>
<p>Primeiros passos no Matplotlib</p>
<p>Gráficos básicos
Para começar, focaremos na elaboração de gráficos fundamentais, abordando os tipos linha, coluna e dispersão.
Exemplo 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2b5b9dce41778fc7e2a27845987c85c972aa6e160d143bae6dd1f6ac03fed70d.png" src="_images/2b5b9dce41778fc7e2a27845987c85c972aa6e160d143bae6dd1f6ac03fed70d.png" />
</div>
</div>
<p>Vamos detalhar o código:</p>
<p>import matplotlib.pyplot as plt</p>
<p>Aqui, importamos o módulo pyplot da biblioteca matplotlib e atribuimos a ele o alias “plt”.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
<p>Duas listas são criadas. A lista x representará os valores no eixo horizontal (eixo x), enquanto a lista y representará os valores no eixo vertical (eixo y).</p>
<p>plt.plot(x, y)</p>
<p>O método plot do pyplot é usado para plotar as listas x e y como um gráfico de linhas. Por padrão, o Matplotlib traçará uma linha contínua azul ligando os pontos definidos pelas listas x e y. Este comando exibe o gráfico criado (figura 74):</p>
<p>plt.show()</p>
<p>Exemplo 2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">etiqueta</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">valor</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">etiqueta</span><span class="p">,</span> <span class="n">valor</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/000a45528d670f1b05a2089e93e85367ea026e2f02d168baa621a1da108c7804.png" src="_images/000a45528d670f1b05a2089e93e85367ea026e2f02d168baa621a1da108c7804.png" />
</div>
</div>
<p>Vamos detalhar o código:</p>
<p><code class="docutils literal notranslate"><span class="pre">etiqueta</span> <span class="pre">=</span> <span class="pre">['A',</span> <span class="pre">'B',</span> <span class="pre">'C']</span></code></p>
<p>Nesta linha, você está definindo uma lista chamada “etiqueta” que contém três strings: ‘A’, ‘B’ e ‘C’. Essas serão as etiquetas (ou rótulos) das barras no gráfico.</p>
<p><code class="docutils literal notranslate"><span class="pre">valor</span> <span class="pre">=</span> <span class="pre">[3,</span> <span class="pre">7,</span> <span class="pre">2]</span></code></p>
<p>Aqui, você está definindo uma lista chamada “valor” que contém três números: 3, 7 e 2. Esses números representarão as alturas das barras correspondentes às etiquetas ‘A’, ‘B’ e ‘C’.</p>
<p>plt.bar(etiqueta, valor)</p>
<p>Esta é a chamada principal para a criação do gráfico de barras. A função bar() do plt (pyplot) é usada para criar gráficos de barra. Ela espera, pelo menos, dois argumentos: os rótulos das barras e os valores das barras. Neste caso, as barras serão rotuladas como ‘A’, ‘B’ e ‘C’, e terão alturas de 3, 7 e 2 unidades, respectivamente.</p>
<p>plt.show()</p>
<p>Por fim, esta linha exibe o gráfico. Ela é responsável por renderizar o gráfico e mostrá-lo ao usuário (figura 75):</p>
<p>Exemplo 3:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ec04b6b0ff985b5a2d2dfe8b9dd4630dcf5f74d0754b0dd7b89d6f73e9d0c87a.png" src="_images/ec04b6b0ff985b5a2d2dfe8b9dd4630dcf5f74d0754b0dd7b89d6f73e9d0c87a.png" />
</div>
</div>
<p>Vamos detalhar o código:</p>
<p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5]</span></code>
Aqui, estamos definindo uma lista chamada x que contém cinco números. Esta lista representará as coordenadas x dos pontos que você deseja plotar no gráfico de dispersão.</p>
<p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">[5,</span> <span class="pre">4,</span> <span class="pre">3,</span> <span class="pre">2,</span> <span class="pre">1]</span></code>
Nesta linha, estamos definindo uma segunda lista chamada y que também contém cinco números. Essa lista representará as coordenadas y correspondentes dos pontos a serem plotados no gráfico.</p>
<p>plt.scatter(x, y)
Esta é a linha principal do código, onde a função scatter() do plt (módulo pyplot da Matplotlib) é chamada para criar um gráfico de dispersão. Ela espera, pelo menos, dois argumentos: as coordenadas x e y dos pontos. Neste caso, estamos instruindo a Matplotlib a criar pontos nas coordenadas (1,5), (2,4), (3,3), (4,2) e (5,1). Por fim:
plt.show()</p>
<p>6.1.3 Personalizando Gráficos com Matplotlib</p>
<p>A efetividade de uma visualização não reside apenas em representar dados, mas também na forma como essa representação é feita. Uma boa personalização pode destacar informações importantes, enquanto uma escolha de design inadequada pode obscurecer ou até mesmo distorcer os dados. O Matplotlib fornece uma grande quantidade de ferramentas para personalizar gráficos, garantindo que eles sejam informativos e esteticamente agradáveis.</p>
<p>Cores, marcadores e linhas
A aparência visual de um gráfico pode ser definida principalmente por suas cores, os marcadores utilizados e os estilos de linha.</p>
<p>Cores
Em Matplotlib, a cor de qualquer elemento do gráfico pode ser alterada. As cores podem ser especificadas de várias maneiras, incluindo nomes comuns (‘red’, ‘blue’, ‘green’), códigos hexadecimais (‘#FF5733’), entre outros.<br />
Exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>  <span class="c1"># linha vermelha</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0c5da81121fccfad42adab603fbba87b7714b7e5bacba07fed67a797d556a7db.png" src="_images/0c5da81121fccfad42adab603fbba87b7714b7e5bacba07fed67a797d556a7db.png" />
</div>
</div>
<p>Marcadores
Em gráficos de dispersão ou pontos específicos de uma linha, os marcadores indicam a localização exata de um ponto. Existem diferentes estilos de marcadores disponíveis, como ‘o’ para círculos, ‘s’ para quadrados, ‘^’ para triângulos, entre outros.<br />
Exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span> <span class="c1"># pontos triangulares</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function matplotlib.pyplot.show(close=None, block=None)&gt;
</pre></div>
</div>
<img alt="_images/bf98ae3e042c6ba5b4b452c656d69b599e10e8334632f504fe2738e8a5800407.png" src="_images/bf98ae3e042c6ba5b4b452c656d69b599e10e8334632f504fe2738e8a5800407.png" />
</div>
</div>
<p>Linhas
Os estilos de linha podem variar, e Matplotlib oferece opções como linhas contínuas (‘-‘), tracejadas (’–‘), pontos e traços (‘-.’), entre outros.<br />
Exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="c1"># linha tracejada  </span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/56f852025e0d73a050c5865a0e3ad3d443ad81ee151cadb39e268651d69462a6.png" src="_images/56f852025e0d73a050c5865a0e3ad3d443ad81ee151cadb39e268651d69462a6.png" />
</div>
</div>
<p>Para simplificar, a Matplotlib permite combinar o estilo de linha, marcador e cor em uma única string. Por exemplo, ‘go-’ significa marcadores verdes circulares com uma linha contínua.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;ro-&#39;</span><span class="p">)</span>  
<span class="c1"># linha contínua vermelha com marcadores circulares</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/61cda61a1b6b318945b3d8525a8dd813b0b79c66a431c648e8d6fddfa394f8bb.png" src="_images/61cda61a1b6b318945b3d8525a8dd813b0b79c66a431c648e8d6fddfa394f8bb.png" />
</div>
</div>
<p>Além disso, a largura da linha e o tamanho do marcador podem ser ajustados usando os argumentos linewidth e markersize, respectivamente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;go-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7147b9c31b61baec2a2404664df9ccd793cbddbcfce021896c9ee732263c111e.png" src="_images/7147b9c31b61baec2a2404664df9ccd793cbddbcfce021896c9ee732263c111e.png" />
</div>
</div>
<p>Ao ajustar esses elementos básicos, já é possível criar gráficos mais informativos e visualmente atraentes.</p>
<p>Rótulos, títulos e legendas
Os rótulos, títulos e legendas são componentes essenciais em visualizações de dados, pois proporcionam contexto e significado, facilitando a interpretação dos gráficos. Vejamos um exemplo na figura 82:</p>
<p>Rótulos: são usados para dar nome aos eixos (x e y) de um gráfico.
Títulos: uma descrição breve e concisa que indica o propósito ou o conteúdo do gráfico.
Legendas: usadas para identificar as diferentes séries ou categorias em um gráfico, especialmente útil quando várias linhas, pontos ou barras são desenhadas no mesmo espaço.</p>
<p>A partir dos elementos apresentados até aqui, podemos sugerir uma estrutura básica para criar um gráfico no Matplotlib:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;linha 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Eixo X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Eixo Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gráfico de linhas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e93dd0de497ac20529f76ad7ed19cd546a31df727752220a940142be20e30b02.png" src="_images/e93dd0de497ac20529f76ad7ed19cd546a31df727752220a940142be20e30b02.png" />
</div>
</div>
<p>Esse é o código para gerar o gráfico da figura 82. Vamos detalhar cada componente:
plt.plot(x, y, label=’Legenda’) é a função principal para plotar gráficos de linhas. Ela toma os valores do eixo x e y como entrada e os plota. O argumento label é usado para associar uma legenda a essa linha específica, o que será útil quando chamarmos plt.legend() mais tarde. Podemos ter diversos outros argumentos, como os responsáveis pela definição de cores, marcadores, tipo e espessura de linhas, entre outros;
plt.xlabel(‘Eixo X’) e plt.ylabel(‘Eixo Y’) são usadas para adicionar rótulos aos eixos x e y, respectivamente;
plt.title(‘Título do Gráfico’) é usada para adicionar um título ao gráfico;
plt.legend() é usada para mostrar as legendas associadas a cada série no gráfico. A legenda é baseada nos labels fornecidos nas chamadas anteriores, como em plt.plot();
plt.show() é usado para exibir o gráfico. Sem chamar essa função, o gráfico pode não ser exibido (dependendo do ambiente em que você está trabalhando).
Esta estrutura básica é suficiente para criar gráficos simples. No entanto, o Matplotlib é uma biblioteca muito versátil e possui muitas outras funcionalidades que permitem personalizar e aprimorar seus gráficos, dependendo da necessidade.</p>
<p>Adicionando texto ao gráfico
Além dos componentes mencionados acima, o Matplotlib permite que você adicione texto em qualquer parte do gráfico.
Use plt.text(x, y, “Texto”) para adicionar um texto na posição (x, y) do gráfico.</p>
<p>Exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;linha 1&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Eixo X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Eixo Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gráfico de linhas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;Texto de exemplo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/13ac10e63febd7be22773f43a596bc0efdc6b7a5f73a4c9d33300f66307c5af5.png" src="_images/13ac10e63febd7be22773f43a596bc0efdc6b7a5f73a4c9d33300f66307c5af5.png" />
</div>
</div>
<p>Nosso exemplo consiste em um gráfico de linhas (figura 83), em que utilizamos a estrutura básica sugerida anteriormente para a criação de gráficos no Matplotlib. Adicionamos plt.text(x, y, ‘texto’) para inserir o texto “Texto de exemplo” na posição x=1 e y=1.5.</p>
<p>Vamos agora plotar um gráfico com duas linhas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dados de exemplo</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">y1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>  

<span class="c1"># Plotando as linhas</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Linha 1&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Linha 2&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span> 

<span class="c1"># Personalizando o gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Eixo X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Eixo Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gráfico de linhas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Mostrando o gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8999768f0f44812be346de6b30d62359d2fa4ebf0a00363293dc8d174eebba3f.png" src="_images/8999768f0f44812be346de6b30d62359d2fa4ebf0a00363293dc8d174eebba3f.png" />
</div>
</div>
<p>6.1.4 Subplots na Matplotlib</p>
<p>Subplots são uma maneira de criar múltiplos gráficos em uma única figura. Eles são úteis quando você quer comparar diferentes conjuntos de dados lado a lado ou quando quer visualizar diferentes aspectos de um mesmo conjunto de dados. Com a combinação de subplots e as diversas funções de plotagem disponíveis, você pode criar uma ampla variedade de visualizações para analisar e apresentar seus dados.
A função plt.subplots() é a maneira mais comum de criar subplots. Ela retorna uma figura e os eixos dos subplots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/98c6795063ed760a9d37f2ca386c068aa402b1714923d6a2bce6111c8b967ed3.png" src="_images/98c6795063ed760a9d37f2ca386c068aa402b1714923d6a2bce6111c8b967ed3.png" />
</div>
</div>
<p>Neste caso, fig é a figura completa, enquanto ax é um único conjunto de eixos. Você pode plotar diretamente neste conjunto de eixos usando métodos como ax.plot().</p>
<p>Especificando o número de subplots
Você pode especificar o número de subplots passando dois argumentos para plt.subplots(): o número de linhas e o número de colunas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  
<span class="c1"># Cria uma grade de 2x3 subplots</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/520b7cd114c729673672657100136658d91ad8e32853bffb1ab464338b36cb08.png" src="_images/520b7cd114c729673672657100136658d91ad8e32853bffb1ab464338b36cb08.png" />
</div>
</div>
<p>Aqui, axs é uma matriz 2x3 contendo os eixos dos subplots. Você pode acessar um subplot específico usando a indexação, como <code class="docutils literal notranslate"><span class="pre">axs[0,</span> <span class="pre">1]</span></code> para o subplot na primeira linha e segunda coluna. A área gráfica gerada é apresentada na figura 86.</p>
<p>Ajustando o Espaçamento
Quando você cria múltiplos subplots, pode ser necessário ajustar o espaçamento entre eles para evitar sobreposição de rótulos ou de títulos. Você pode fazer isso usando plt.tight_layout() ou ajustando manualmente com fig.subplots_adjust().</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<p>ou</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
    <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Em que:
left, right, top, bottom controlam o espaçamento em relação à figura.
wspace e hspace controlam o espaçamento entre subplots.
Para visualizar o resultado:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a73e978a00d3d1de572938cf478e335f1319463893a3849a0fbdf3cc80f390cf.png" src="_images/a73e978a00d3d1de572938cf478e335f1319463893a3849a0fbdf3cc80f390cf.png" />
</div>
</div>
<p>Plotando nos Subplots
Uma vez que você tenha seus subplots definidos, você pode plotar neles usando os métodos de plotagem do objeto de eixos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Subplot 1&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Subplot 2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">  File</span><span class="nn"> &quot;/tmp/ipykernel_8266/630037447.py&quot;</span><span class="gt">, line </span><span class="mi">3</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Subplot 2</span>
                                                       <span class="o">^</span>
<span class="ne">SyntaxError</span>: EOL while scanning string literal
</pre></div>
</div>
</div>
</div>
<p>Títulos e Rótulos
Você pode adicionar títulos e rótulos a cada subplot individualmente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Título do Subplot 1&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Eixo X do Subplot 1&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Eixo Y do Subplot 1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Compartilhando Eixos
Se você estiver comparando dados em diferentes subplots e quiser que eles compartilhem o mesmo eixo X ou Y, você pode usar o argumento sharex ou sharey:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Neste exemplo, ambos subplots compartilharão o mesmo eixo X.</p>
<p>Exemplo: Criando múltiplos gráficos em uma única figura.
a) Usando plt.subplots():
O método plt.subplots() retorna uma figura e uma matriz de objetos “axes” (eixos), que são as áreas individuais de plotagem.</p>
<p>Etapa 1: Importação de biblioteca e criação da figura e dos subplots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># Criar a figura e os subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Nesse código, plt.subplots() retorna uma figura (fig) e os eixos (ax) dos subplots; nrows=2, ncols=2 define uma matriz 2x2, resultando em 4 subplots; figsize=(10, 10) define o tamanho da figura. Neste caso, a figura terá 10x10 polegadas.</p>
<p>Etapa 2: Plotando os gráficos em cada subplot.
Cada subplot é referenciado usando a indexação <code class="docutils literal notranslate"><span class="pre">ax[row,</span> <span class="pre">col]</span></code>. Por exemplo, <code class="docutils literal notranslate"><span class="pre">ax[0,</span> <span class="pre">0]</span></code> refere-se ao subplot superior esquerdo, enquanto <code class="docutils literal notranslate"><span class="pre">ax[1,</span> <span class="pre">1]</span></code> é o subplot inferior direito.</p>
<section class="tex2jax_ignore mathjax_ignore" id="primeiro-subplot-superior-esquerdo">
<h1>Primeiro subplot (superior esquerdo)<a class="headerlink" href="#primeiro-subplot-superior-esquerdo" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gráfico de Linha&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="segundo-subplot-superior-direito">
<h1>Segundo subplot (superior direito)<a class="headerlink" href="#segundo-subplot-superior-direito" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gráfico de Dispersão&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="terceiro-subplot-inferior-esquerdo">
<h1>Terceiro subplot (inferior esquerdo)<a class="headerlink" href="#terceiro-subplot-inferior-esquerdo" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gráfico de Barras&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="quarto-subplot-inferior-direito">
<h1>Quarto subplot (inferior direito)<a class="headerlink" href="#quarto-subplot-inferior-direito" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histograma&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Os seguintes métodos são usados para criar os gráficos: .plot() cria o gráfico de linha; .scatter() cria o gráfico de dispersão; .bar() cria o gráfico de barras; .hist() cria o histograma; set_title é usado para definir o título de cada subplot.</p>
<p>Etapa 3: Ajustando e visualizando a figura.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>O método tight_layout() ajusta o espaçamento entre os subplots para que não se sobreponham.</p>
<p>6.1.5 Gráficos com dados reais</p>
<p>Para exemplificar a criação de gráficos com dados reais, vamos criar um gráfico para visualizar a precipitação mensal (em mm) registrada na estação meteorológica do INMET, código A827, instalada no município de Bagé-RS nos anos de 2021, 2022 e 2023. Os dados estão armazenados em um arquivo CSV.
O código completo para ler o arquivo e criar o gráfico é:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">df_precipitacao</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/precipitacao_A827.csv&#39;</span><span class="p">)</span>
<span class="n">df_precipitacao</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df_precipitacao</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="s1">&#39;mediumseagreen&#39;</span><span class="p">,</span> <span class="s1">&#39;silver&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Mês&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Precipitação mensal (mm)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Precipitação: Estação INMET A827(Bagé)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">df_precipitacao</span><span class="p">[</span><span class="s1">&#39;Mês&#39;</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Figura 92: Precipitação na estação climatológica INMET A827 entre 2021 e 2023.</p>
<p>Vamos analisar o código por partes:</p>
<p>import pandas as pd
import matplotlib.pyplot as plt
df_precipitacao = pd.read_csv(‘/content/precipitacao_A827.csv’)
df_precipitacao.head()</p>
<p>Aqui realizamos a leitura do arquivo CSV denominado precipitacao_A827.CSV. Os dados do arquivo são armazenados no DataFrame chamado df_precipitacao. Em seguida, as primeiras cinco linhas do DataFrame são impressas usando o método head().</p>
<p>ax = df_precipitacao.plot(kind=’bar’, figsize=(10, 6), width=0.8,
<code class="docutils literal notranslate"><span class="pre">color=['steelblue',</span> <span class="pre">'mediumseagreen',</span> <span class="pre">'silver'])</span></code></p>
<p>Nesse código, df_precipitacao.plot(…) utiliza a função plot() do DataFrame df_precipitacao para criar um gráfico; kind=’bar’ especifica que o tipo de gráfico desejado é um gráfico de barras; figsize=(10, 6) define o tamanho da figura como 10 unidades de largura por 6 unidades de altura; width=0.8 define a largura das barras como 80% da largura padrão entre os ticks do eixo x; <code class="docutils literal notranslate"><span class="pre">color=['steelblue',</span> <span class="pre">'mediumseagreen',</span> <span class="pre">'silver']</span></code> define as cores das barras.</p>
<p>ax.set_xlabel(‘Mês’)</p>
<p>Define o rótulo do eixo x como “Mês”.</p>
<p>ax.set_ylabel(‘Precipitação mensal (mm)’)
Define o rótulo do eixo y como “Precipitação mensal (mm)”.</p>
<p>ax.set_title(‘Precipitação: Estação INMET A827(Bagé)’)
Estabelece o título do gráfico.</p>
<p><code class="docutils literal notranslate"><span class="pre">ax.set_xticklabels(df_precipitacao['Mês'],</span> <span class="pre">rotation=45)</span></code>
Define os rótulos do eixo x com os valores da coluna ‘Mês’ do DataFrame df_precipitacao e roda esses rótulos em 45 graus para melhor visualização.</p>
<p>ax.legend()
Exibe a legenda do gráfico, que, por padrão, usará os nomes das colunas do DataFrame como rótulos.</p>
<p>plt.tight_layout()
Ajusta automaticamente o layout da figura para garantir que tudo seja exibido corretamente.</p>
<p>plt.show()
Exibe a figura (figura x). Se você estiver usando um Jupyter Notebook ou um ambiente IPython, a figura será exibida diretamente abaixo da célula que contém o código. Em outros ambientes, isso pode abrir uma janela com a figura.</p>
<p>6.1.6 Exportando Gráficos</p>
<p>Quando você cria um gráfico, seja para análise de dados, apresentações ou publicações, muitas vezes é necessário exportá-lo para um formato de arquivo específico. A exportação de gráficos envolve várias considerações, incluindo o formato de arquivo, resolução e qualidade. A escolha certa depende do uso pretendido do gráfico e das especificações do meio em que será apresentado.</p>
<p>Formatos
Existem vários formatos de arquivo para os quais você pode exportar um gráfico, e a escolha do formato depende do uso pretendido. Alguns dos formatos mais comuns incluem:
PNG (Portable Network Graphics): É um formato de imagem matricial, o que significa que ele armazena o gráfico como uma coleção de pixels. É amplamente usado devido à sua compressão sem perdas e suporte a transparência;
JPEG (Joint Photographic Experts Group): Também é um formato de imagem matricial, mas usa compressão com perdas, o que pode reduzir a qualidade da imagem. É mais adequado para fotografias do que para gráficos;
SVG (Scalable Vector Graphics): É um formato de imagem vetorial, o que possibilita que o gráfico seja redimensionado sem perder qualidade;
PDF (Portable Document Format): É um formato de arquivo versátil que pode conter gráficos vetoriais e matriciais. É amplamente usado para publicações e impressão.</p>
<p>Resolução
A resolução refere-se ao número de pixels por polegada (PPI) ou pontos por polegada (DPI) em uma imagem. Uma resolução mais alta resulta em uma imagem mais nítida, mas também em um tamanho de arquivo maior. A resolução ideal depende de onde o gráfico será usado:
Tela (web, apresentações): Geralmente, uma resolução de 72 PPI é suficiente;
Impressão: Para obter uma imagem nítida, é recomendável uma resolução de pelo menos 300 DPI.</p>
<p>Qualidade
A qualidade refere-se à quantidade de detalhes e clareza em uma imagem. Em formatos de compressão com perdas, como JPEG, você pode escolher um nível de qualidade ao exportar. Uma qualidade mais alta resultará em uma imagem mais nítida, mas também em um tamanho de arquivo maior. Por outro lado, uma qualidade mais baixa reduzirá o tamanho do arquivo, mas também a nitidez da imagem. Ao exportar gráficos, é importante equilibrar a qualidade e o tamanho do arquivo, considerando o propósito pretendido do gráfico.</p>
<p>Exportando o gráfico de precipitação da estação A827
Para exportar o último gráfico criado com os dados de precipitação da estação climatológica A827 no contexto do Matplotlib, utilizamos o método savefig(). Vamos criar um arquivo em formato PNG, com resolução de 300dpi.</p>
<p>plt.savefig(‘precipitacao_2021-2023_A827.png’, format=’png’, dpi=300)</p>
<p>É importante ressaltar que o método savefig() deve ser posicionado antes do método .show para que o gráfico seja exportado corretamente. O código atualizado com esta linha é:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">df_precipitacao</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/precipitacao_A827.csv&#39;</span><span class="p">)</span>
<span class="n">df_precipitacao</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df_precipitacao</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="s1">&#39;mediumseagreen&#39;</span><span class="p">,</span> <span class="s1">&#39;silver&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Mês&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Precipitação mensal (mm)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Precipitação: Estação INMET A827(Bagé)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">df_precipitacao</span><span class="p">[</span><span class="s1">&#39;Mês&#39;</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;precipitacao_2021-2023_A827.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Depois de executar este código, você encontrará o gráfico exportado como um arquivo PNG com a resolução especificada, no diretório atual de trabalho.</p>
<p>6.2 Função de plotagem integrada do GeoPandas.</p>
<p>Como vimos no capítulo anterior, o Geopandas é uma extensão do Pandas, uma das bibliotecas mais populares para análise de dados em Python. Ele facilita o trabalho com dados geoespaciais, incorporando estruturas para manipulação de geometrias.
Com o Geopandas, é possível realizar a plotagem básica de dados geográficos com facilidade. Um simples comando plot() aplicado a um GeoDataFrame ou GeoSeries gera uma representação visual dos dados. Por exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="n">gdf_uf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/content/BR_UF.shp&#39;</span><span class="p">)</span>
<span class="n">gdf_uf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>A seguir, exploraremos as opções de personalização do método plot. A visualização padrão é prática, mas muitas vezes precisamos modificar cores, legendas e outros detalhes para melhorar a apresentação dos dados. Entender essas opções nos ajudará a produzir gráficos mais claros e adequados ao nosso propósito.</p>
<p>a) Definição da cor de preenchimento
O blue é a cor padrão quando plotamos utilizando o .plot(). Para aplicar outra cor a todas as geometrias do GeoDataFrame, você pode usar o argumento color.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf_uf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Atribuindo cores diferentes de acordo com os atributos
Para colorir geometrias com base nos valores de uma coluna (atributo) específica, você pode utilizar os argumentos column e cmap (mapa de cores). Vamos criar uma visualização do gdf_uf, atribuindo cores a cada geometria com base nos valores da coluna NM_REGIAO e usando o esquema de cores Pastel2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf_uf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;NM_REGIAO&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Pastel2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>O cmap, abreviação de Colormap, refere-se a uma escala de cores ou um mapa de cores no Matplotlib e em outras bibliotecas de visualização. O Matplotlib oferece uma variedade de colormaps pré-definidos que podem ser usados conforme o tipo de dado e a preferência visual. Alguns exemplos de colormaps no Matplotlib incluem:
Sequenciais: São adequados para dados que vão de valores baixos a altos. Exemplos: Blues, Greens, OrRd.
Divergentes: São adequados para dados que têm um valor médio significativo e variações nos dois extremos (baixo e alto). Exemplos: RdBu (Vermelho-Azul), coolwarm.
Cíclicos: São adequados para dados que têm valores repetidos em ciclos. Exemplo: twilight.
Qualitativos: São usados para representar informações categóricas. Exemplo: tab10. Para mais detalhes, consulte (<a class="reference external" href="https://matplotlib.org/stable/users/explain/colors/colormaps.html">https://matplotlib.org/stable/users/explain/colors/colormaps.html</a>).</p>
<p>Personalizando as linhas de borda
Usando edgecolor e linewidth, você pode personalizar a cor e a largura das linhas de borda das geometrias. Exemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf_uf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Configuração de legenda e barra de cores
Ao usar o argumento legend=True, você pode adicionar uma legenda ou barra de cores para representar os valores dos dados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf_uf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;NM_REGIAO&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Pastel2&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Estes são apenas alguns exemplos básicos de como você pode personalizar a plotagem de seus dados geográficos no Geopandas. Como o Geopandas se integra perfeitamente ao Matplotlib, as possibilidades são amplas e permitem muita personalização. Estudaremos a integração do Geopandas com a Matplotlib a seguir.</p>
<p>6.3 Integração do Geopandas com Matplotlib</p>
<p>Quando você usa o método .plot() do Geopandas, ele já está usando o matplotlib implicitamente. No entanto, para uma integração mais profunda e personalizada, você pode usar a matplotlib explicitamente.
Essa integração é bastante direta e traz várias vantagens, dentre elas:
Personalização Avançada: O matplotlib oferece uma ampla gama de opções de personalização, permitindo que você ajuste quase todos os aspectos do seu gráfico;
Combinação de Gráficos: Você pode combinar seu mapa com outros tipos de gráficos, como gráficos de barras, linhas ou scatter plots, em uma única figura;
Subplots: Como discutido anteriormente, o matplotlib permite criar subplots. Isso é útil se você quiser mostrar vários mapas lado a lado para comparação;
Controle de Legenda: O matplotlib oferece opções avançadas para personalizar a legenda do seu gráfico, incluindo posição, tamanho, cor e muito mais;
Integração com Outras Bibliotecas: Ao usar o matplotlib como base, você pode facilmente integrar seu mapa com outras bibliotecas de visualização que também usam o matplotlib, como seaborn;
Exportação Flexível: O matplotlib oferece várias opções para exportar seu gráfico, permitindo que você escolha formatos, resoluções e outros parâmetros de exportação;
Interatividade: Embora o matplotlib seja principalmente uma biblioteca de plotagem estática, ele tem algumas funcionalidades interativas, especialmente quando usado em ambientes como o Jupyter Notebook.</p>
<p>Em resumo, integrar o Geopandas com a Matplotlib oferece uma maior flexibilidade e controle sobre a visualização dos seus dados geoespaciais. Vamos explorar algumas opções de personalização a seguir.</p>
<p>Configuração das etiquetas dos eixos
O método .plot() do Geopandas retorna um objeto de eixos (ax) do matplotlib, e você pode usar esse objeto para ajustar as propriedades dos eixos, incluindo o tamanho do texto das etiquetas dos eixos.
As etiquetas dos eixos na Matplotlib são altamente configuráveis. O método ax.tick_params() pode ser usado para ajustar várias propriedades das etiquetas dos eixos e dos marcadores (ticks) ao mesmo tempo.
Vamos reduzir o tamanho do texto referente aos valores das coordenadas geográficas em nosso GeoDataFrame gdf_uf:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Plotando o GeoDataFrame</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">gdf_uf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Ajustando o tamanho do texto das etiquetas dos eixos:</span>
<span class="c1"># Ajuste o tamanho desejado para &#39;7&#39;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>No método ax.tick_params(), o argumento labelsize define o tamanho do texto. Você pode ajustar esse valor conforme necessário. which=’major’ indica que a configuração será realizada com o eixo principal da plotagem.</p>
<p>Além de ax.tick_params(), existem outros métodos e propriedades para ajustar as etiquetas dos eixos e os ticks. A documentação oficial do matplotlib é uma excelente fonte para verificar as opções disponíveis e obter exemplos detalhados. Você pode encontrar mais informações sobre ax.tick_params() e outras funcionalidades relacionadas na documentação da matplotlib, em: (<a class="reference external" href="https://matplotlib.org/stable/api/axis_api.html">https://matplotlib.org/stable/api/axis_api.html</a>).</p>
<p>Mais exemplos de integração entre Geopandas e Matplotlib
Exemplo 1: Plotando um único GeoDataFrame</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Usando o método .plot() do GeoDataFrame e passando o eixo criado</span>
<span class="n">gdf_uf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkseagreen&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Personalizando com Matplotlib</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Brasil&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>

<span class="c1"># Mostrando o gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Resumidamente, este código carrega um conjunto de dados geoespaciais do Brasil a partir de um arquivo shapefile, cria uma figura e eixos usando matplotlib, plota os dados geoespaciais no gráfico, personaliza o gráfico e, em seguida, exibe o gráfico resultante.
Vamos analisar o código passo a passo.
fig, ax = plt.subplots(figsize=(10, 10))</p>
<p>Uma figura e eixos são criados usando a função subplots do matplotlib. A figura terá um tamanho de 10x10 polegadas.
gdf_uf.plot(ax=ax, color=’darkseagreen’, edgecolor=’black’)</p>
<p>O método .plot() do GeoDataFrame (gdf_uf) é usado para visualizar os dados geoespaciais. O argumento ax=ax indica que o plot deve ser feito nos eixos previamente criados. O argumento color=’darkseagreen’ define a cor de preenchimento das unidades federativas, enquanto edgecolor=’black’ define a cor das bordas.</p>
<p>ax.set_title(‘Brasil’)
ax.set_xlabel(‘Longitude’)
ax.set_ylabel(‘Latitude’)</p>
<p>Aqui, o gráfico é personalizado usando funções do matplotlib. O título do gráfico é definido como “Brasil”, e os rótulos dos eixos x e y são definidos como “Longitude” e “Latitude”, respectivamente.</p>
<p>Exemplo 2: Plotando uma geometria e o conteúdo de uma coluna
Vamos plotar a mesma figura anterior, mas inserindo na visualização a sigla referente a cada estado. Para tanto, vamos utilizar a função annotate da matplotlib. A ideia é iterar sobre cada geometria (neste caso, cada estado) no GeoDataFrame e adicionar uma anotação (o nome do estado) à sua posição central.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Criando uma figura e eixos com Matplotlib</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Usando o método .plot() do GeoDataFrame e passando o eixo criado</span>
<span class="n">gdf_uf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkseagreen&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Adicionando os nomes dos estados</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">gdf_uf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> 
    <span class="n">gdf_uf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">gdf_uf</span><span class="p">[</span><span class="s1">&#39;SIGLA_UF&#39;</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> 
        <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># Personalizando com Matplotlib</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Brasil&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>

<span class="c1"># Mostrando o gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Neste código, a parte chave é o loop for que itera sobre as coordenadas centrais de cada geometria (usando gdf_uf.geometry.centroid.x e gdf_uf.geometry.centroid.y) e os nomes dos estados <code class="docutils literal notranslate"><span class="pre">(usando</span> <span class="pre">gdf_uf['NM_UF']).</span></code> Para cada estado, a função annotate adiciona o nome do estado à sua posição central no gráfico. O argumento xytext=(0,-2) e textcoords=”offset points” são usados para garantir que o texto não seja colocado exatamente no centro da geometria, mas ligeiramente deslocado para evitar sobreposições com as bordas das geometrias.</p>
<p>Exemplo 3: Plotando camadas de geometrias sobrepostas
Vamos criar uma plotagem das rodovias do estado de Sergipe sobrepostas a geometria desse estado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gdf_gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">gdf_sergipe</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/content/sergipe_UF.shp&#39;</span><span class="p">)</span>
<span class="n">gdf_rodovias</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/content/sergipe_rodo.shp&#39;</span><span class="p">)</span>

<span class="c1"># Criar uma figura e eixos com Matplotlib</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Plotar a geometria do estado do Sergipe como fundo</span>
<span class="n">gdf_sergipe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Plotar as rodovias sobrepostas ao estado</span>
<span class="n">gdf_rodovias</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Personalizar com Matplotlib: inserir um título</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Rodovias de Sergipe&#39;</span><span class="p">)</span>

<span class="c1"># Plotar o gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Neste exemplo, a geometria do estado do Sergipe é plotada primeiro com uma cor de fundo lightgray e borda black. As rodovias são então plotadas por cima com uma cor red e uma largura de linha de 1.0.</p>
<p>É possível criar uma visualização sem os eixos de coordenadas, o que é útil em muitas situações. A chamada ax.axis(‘off’) pode ser usada para isso:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">gdf_sergipe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">gdf_rodovias</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Rodovias de Sergipe&#39;</span><span class="p">)</span>

<span class="c1"># Removendo os eixos para uma visualização mais limpa</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Exemplo 4: Classificando um tema por categorias
O GeoDataFrame gdf_rodovias tem uma coluna chamada jurisdição que especifica a jurisdição de cada segmento de rodovia (Federal, Estadual, Municipal ou desconhecida). Vamos gerar uma plotagem das rodovias de Sergipe, categorizadas de acordo com a sua jurisdição. Para tanto, vamos utilizar o argumento column no método plot e adicionar uma legenda.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Criar uma figura e eixos com Matplotlib</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plotar a geometria do estado do Sergipe como fundo</span>
<span class="n">gdf_sergipe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Plotar as rodovias classificadas por jurisdição</span>
<span class="n">gdf_rodovias</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;jurisdicao&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> 
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1"># Inserir o título</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Rodovias de Sergipe por Jurisdição&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Remover os eixos para uma visualização mais limpa</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Ajustar a posição da legenda</span>
<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
<span class="n">leg</span><span class="o">.</span><span class="n">set_bbox_to_anchor</span><span class="p">((</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">))</span>

<span class="c1"># Ajustar o layout automaticamente</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Mostrar o gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Neste código: leg.set_bbox_to_anchor((0.9, 0.3)) ajusta a posição da legenda para que ela não sobreponha o gráfico.</p>
<p>Exemplo 6: Mapa coroplético
Vamos criar uma visualização da distribuição espacial da população por município para o estado de Santa Catarina (dados referentes ao ano de 2021). Para simplificar, usaremos aqui o termo ‘mapa coroplético’, mesmo que alguns dos elementos que constituem um mapa por definição (como a escala gráfica ou numérica) não estejam presentes nessa visualização.
Inicialmente, vamos importar as bibliotecas, ler o arquivo shapefile e plotar as primeiras linhas do GeoDataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">gdf_sc</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/content/censo_mun_sc.shp&#39;</span><span class="p">)</span>
<span class="n">gdf_sc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf_sc</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Para criar o mapa coroplético, vamos utilizar o seguinte código:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definir o tamanho da figura</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Criar o mapa</span>
<span class="n">gdf_sc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;pop_2021&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;OrRd&#39;</span><span class="p">)</span>

<span class="c1"># Criar a barra de cores (colorbar) manualmente</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;População por Município&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># Ajustar o tamanho do texto dos eixos de coordenadas</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span> 

<span class="c1"># Adicionar título e exibindo o mapa</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribuição da População por Município&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Vamos detalhar o código:</p>
<p>fig, ax = plt.subplots(figsize=(10, 10))</p>
<p>Esta linha cria uma figura (fig) e um conjunto de eixos (ax) com um tamanho especificado de 10x10 polegadas.</p>
<p>gdf_sc.plot(column=’pop_2021’, ax=ax, cmap=’OrRd’)</p>
<p>Aqui, estamos usando o método plot do GeoDataFrame gdf_sc para criar um mapa coroplético. Estamos atribuindo cores aos municípios com base nos valores da coluna pop_2021, usando o cmap ‘OrRd’. O argumento ax=ax especifica que queremos plotar os dados no conjunto de eixos que criamos anteriormente.</p>
<p><code class="docutils literal notranslate"><span class="pre">cbar</span> <span class="pre">=</span> <span class="pre">plt.colorbar(ax.collections[0],</span> <span class="pre">ax=ax,</span> <span class="pre">shrink=0.5)</span></code></p>
<p>Esta linha adiciona uma barra de cores (colorbar) ao gráfico. A barra de cores fornece uma referência visual para mapear cores individuais para valores de dados. O argumento shrink=0.5 especifica que a barra de cores deve ser reduzida para metade do tamanho do eixo.</p>
<p>cbar.set_label(‘População por Município’, size=10)</p>
<p>Aqui, estamos definindo um rótulo para a barra de cores com o texto “População por Município” e especificando que o tamanho da fonte do rótulo deve ser 10.</p>
<p>cbar.ax.tick_params(labelsize=9)</p>
<p>O código acima ajusta os parâmetros dos ticks (marcadores) da barra de cores. Estamos definindo o tamanho da fonte dos rótulos dos marcadores para 9.</p>
<p>Na figura acima, a vasta diferença nos valores populacionais entre os municípios tornou a visualização desbalanceada e pouco informativa. Isso porque municípios com populações muito altas contrastavam fortemente com aqueles de população menor, obscurecendo nuances e padrões regionais. Para proporcionar uma interpretação mais clara dos dados, vamos ajustar a representação para uma escala logarítmica. Esse ajuste pode equilibrar visualmente as variações populacionais, tornando o mapa mais compreensível e revelando detalhes anteriormente ofuscados pela discrepância nos valores absolutos. Para criar essa visualização, utilizamos o código:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcolors</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>

<span class="c1"># Definir o tamanho da figura</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Criar uma coluna logarítmica</span>
<span class="n">gdf_sc</span> <span class="o">=</span> <span class="n">gdf_sc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">gdf_sc</span><span class="p">[</span><span class="s1">&#39;pop_2021_log&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gdf_sc</span><span class="p">[</span><span class="s1">&#39;pop_2021&#39;</span><span class="p">])</span>

<span class="c1"># Definir o colormap</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;OrRd&#39;</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">gdf_sc</span><span class="p">[</span><span class="s1">&#39;pop_2021&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
    <span class="n">vmax</span><span class="o">=</span><span class="n">gdf_sc</span><span class="p">[</span><span class="s1">&#39;pop_2021&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="c1"># Plotar o mapa coroplético com escala logarítmica</span>
<span class="n">gdf_sc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;pop_2021_log&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Criar uma legenda personalizada</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<span class="c1"># Ajustar as dimensões da legenda</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cbar</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="c1"># Ajustar o tamanho do título da legenda</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;População&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  
<span class="c1"># Ajustar o tamanho dos ticks da legenda</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>      

<span class="c1"># Ajustar o tamanho do texto dos eixos de coordenadas</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span> 

<span class="c1"># Adicionar título e exibir o mapa</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribuição da População por Município - SC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Vamos analisar as diferenças com relação ao código anterior:</p>
<p>import matplotlib.pyplot as plt
import numpy as np
import matplotlib.colors as mcolors
import <a class="reference external" href="http://matplotlib.cm">matplotlib.cm</a> as cm</p>
<p>Aqui, além da Matplotlib importamos o numpy, e os módulos matplotlib.colors e <a class="reference external" href="http://matplotlib.cm">matplotlib.cm</a>, que são usados para trabalhar com mapas de cores.</p>
<p>gdf_sc = gdf_sc.copy()
<code class="docutils literal notranslate"><span class="pre">gdf_sc['pop_2021_log']</span> <span class="pre">=</span> <span class="pre">np.log(gdf_sc['pop_2021'])</span></code></p>
<p>Cria uma cópia do GeoDataFrame gdf_sc para evitar alterações no original. Em seguida, adiciona uma nova coluna pop_2021_log que contém o logaritmo natural dos valores da coluna pop_2021.</p>
<p>cmap = ‘OrRd’</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">gdf_sc</span><span class="p">[</span><span class="s1">&#39;pop_2021&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
    <span class="n">vmax</span><span class="o">=</span><span class="n">gdf_sc</span><span class="p">[</span><span class="s1">&#39;pop_2021&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
<p>Define o mapa de cores como ‘OrRd’ e cria um objeto de normalização que mapeia os valores da coluna pop_2021 para o intervalo <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>.</p>
<p>gdf_sc.plot(column=’pop_2021_log’, ax=ax, cmap=cmap, legend=False)</p>
<p>Plota o mapa coroplético usando a coluna pop_2021_log e o mapa de cores definido anteriormente. A legenda não é mostrada porque legend=False.</p>
<p>cbar = plt.cm.ScalarMappable(norm=norm, cmap=cmap)
<code class="docutils literal notranslate"><span class="pre">cbar_ax</span> <span class="pre">=</span> <span class="pre">fig.add_axes([0.95,</span> <span class="pre">0.25,</span> <span class="pre">0.02,</span> <span class="pre">0.5])</span></code>
cb = fig.colorbar(cbar, cax=cbar_ax, orientation=’vertical</p>
<p>Cria uma legenda personalizada para o mapa; plt.cm.ScalarMappable é usado para mapear os valores da coluna pop_2021 para cores no mapa de cores; fig.add_axes adiciona um novo conjunto de eixos à figura para a legenda, e fig.colorbar adiciona a legenda à figura.</p>
<p>Ao utilizar a escala logarítmica, foi possível representar de forma mais eficaz a distribuição populacional, realçando tanto áreas densamente quanto escassamente povoadas.</p>
<p>Exemplo 7: Múltiplos plots em uma visualização
A visualização simultânea de múltiplos conjuntos de dados geoespaciais pode proporcionar uma compreensão abrangente das características e relações territoriais de uma área. No exemplo a seguir, exploraremos o uso de subplots para visualizar, lado a lado: os estados, os biomas e as regiões hidrográficas do Brasil. Para facilitar o entendimento, inicialmente vamos apresentar o código sem a configuração de estilos de cores, dos textos e de legendas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Leitura dos arquivos</span>
<span class="n">gdf_uf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/content/BR_UF.shp&#39;</span><span class="p">)</span>
<span class="n">gdf_bio</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/content/biomas.shp&#39;</span><span class="p">)</span>
<span class="n">gdf_hid</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/content/regioes_hidro.shp&#39;</span><span class="p">)</span>

<span class="c1"># Criando uma figura com três subplots (um ao lado do outro)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Plotando gdf_uf no primeiro subplot</span>
<span class="n">gdf_uf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Estados&#39;</span><span class="p">)</span>

<span class="c1"># Plotando gdf_bio no segundo subplot</span>
<span class="n">gdf_bio</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Biomas&#39;</span><span class="p">)</span>

<span class="c1"># Plotando gdf_hid no terceiro subplot</span>
<span class="n">gdf_hid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Regiões Hidrográficas&#39;</span><span class="p">)</span>

<span class="c1"># Ajustando a apresentação</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>No código acima:</p>
<p>fig, axs = plt.subplots(1, 3, figsize=(15, 5))</p>
<p>Aqui, usamos o método plt.subplots() para criar uma figura (fig) e três subplots (axs). O argumento “1, 3” indica que queremos 1 linha e 3 colunas de subplots, ou seja, três áreas de plotagem lado a lado. O argumento figsize=(15, 5) define o tamanho total da figura como 15x5 polegadas.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdf_uf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Estados&#39;</span><span class="p">)</span>

<span class="n">gdf_bio</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Biomas&#39;</span><span class="p">)</span>

<span class="n">gdf_hid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Regiões Hidrográficas&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Neste código, estamos plotando o gdf_uf (que representa os estados) no primeiro subplot (área de plotagem axs[0]). Em seguida, definimos um título para esse subplot. Da mesma forma, estamos plotando o gdf_bio (que representa os biomas) no segundo subplot (área de plotagem axs[1]) e definindo um título para ele. Por fim, estamos plotando o gdf_hid (que representa as regiões hidrográficas) no terceiro subplot (área de plotagem axs[2]) e definindo um título para ele.```

for ax in axs:
    ax.axis(&#39;off&#39;)

plt.tight_layout()
plt.show()

Aqui, estamos percorrendo cada subplot (área de plotagem) e desativando os eixos usando ax.axis(&#39;off&#39;), o que remove os rótulos e os marcadores dos eixos, tornando a visualização mais limpa. plt.tight_layout() ajusta automaticamente o tamanho e a posição dos subplots para que eles se ajustem bem na figura; plt.show() exibe a figura criada.
	Agora vamos alterar o código, adicionando as configurações de texto, legendas e categorias:

```{code-cell} python
# Criando uma figura e três eixos
fig, axs = plt.subplots(nrows=1, ncols=3, figsize=(15, 5))

# Argumentos para a legenda
legend_args = {
    &#39;loc&#39;: &#39;lower left&#39;,
    &#39;fontsize&#39;: &#39;small&#39;  # Reduzindo o tamanho da fonte da legenda
}

# Plotando o mapa dos estados brasileiros no primeiro eixo
gdf_uf.plot(column=&#39;SIGLA_UF&#39;, ax=axs[0], cmap=&#39;Pastel2&#39;, edgecolor=&#39;black&#39;)
axs[0].set_title(&#39;Estados Brasileiros&#39;)

# Plotando o mapa dos biomas do Brasil no segundo eixo
gdf_bio.plot(column=&#39;NOME&#39;, ax=axs[1], cmap = &#39;Greens&#39;, edgecolor=&#39;black&#39;, 
    legend=True, legend_kwds=legend_args)
axs[1].set_title(&#39;Biomas do Brasil&#39;)

# Plotando o mapa das regiões hidrográficas do Brasil no terceiro eixo
gdf_hid.plot(column=&#39;RHI_NM&#39;, ax=axs[2], cmap=&#39;Blues&#39;, edgecolor=&#39;black&#39;, 
    legend=True, legend_kwds=legend_args)
axs[2].set_title(&#39;Regiões Hidrográficas do Brasil&#39;)

# Removendo os eixos x e y para uma visualização mais limpa
for ax in axs:
    ax.axis(&#39;off&#39;)

# Ajustando o layout com um espaçamento reduzido
plt.tight_layout(pad=0.1)
plt.show()
</pre></div>
</div>
<p>Vamos analisar o código:
fig, axs = plt.subplots(nrows=1, ncols=3, figsize=(15, 5))
Aqui, usamos o método plt.subplots() para criar uma figura (fig) e três eixos (axs), da mesma maneira que no código anterior.</p>
<p>legend_args = {
‘loc’: ‘lower left’,
‘fontsize’: ‘small’  # Reduzindo o tamanho da fonte da legenda
}</p>
<p>Neste trecho, definimos um dicionário legend_args que contém argumentos para personalizar a legenda dos plots. A legenda é posicionada no canto inferior esquerdo (‘loc’: ‘lower left’) e tem tamanho de fonte pequeno (‘fontsize’: ‘small’).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdf_uf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;SIGLA_UF&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Pastel2&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Estados Brasileiros&#39;</span><span class="p">)</span>

<span class="n">Aqui</span><span class="p">,</span> <span class="n">plotamos</span> <span class="n">o</span> <span class="n">gdf_uf</span> <span class="n">no</span> <span class="n">primeiro</span> <span class="n">eixo</span> <span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="n">e</span> <span class="n">atribuímos</span> <span class="n">cores</span> <span class="n">aos</span> <span class="n">estados</span> <span class="n">com</span> <span class="n">base</span> <span class="n">na</span> <span class="n">coluna</span> <span class="s1">&#39;SIGLA_UF&#39;</span> <span class="n">usando</span> <span class="n">o</span> <span class="n">mapa</span> <span class="n">de</span> <span class="n">cores</span> <span class="n">Pastel2</span><span class="o">.</span> <span class="n">As</span> <span class="n">bordas</span> <span class="n">dos</span> <span class="n">estados</span> <span class="n">são</span> <span class="n">definidas</span> <span class="n">como</span> <span class="n">pretas</span> <span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span><span class="o">.</span> <span class="n">Em</span> <span class="n">seguida</span><span class="p">,</span> <span class="n">definimos</span> <span class="n">um</span> <span class="n">título</span> <span class="n">para</span> <span class="n">esse</span> <span class="n">eixo</span><span class="o">.</span>

<span class="n">gdf_bio</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;NOME&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Greens&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_kwds</span><span class="o">=</span><span class="n">legend_args</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Biomas do Brasil&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Neste</span> <span class="n">trecho</span><span class="p">,</span> <span class="n">estamos</span> <span class="n">plotando</span> <span class="n">o</span> <span class="n">gdf_bio</span> <span class="n">no</span> <span class="n">segundo</span> <span class="n">eixo</span> <span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="n">e</span> <span class="n">atribuindo</span> <span class="n">cores</span> <span class="n">aos</span> <span class="n">biomas</span> <span class="n">com</span> <span class="n">base</span> <span class="n">na</span> <span class="n">coluna</span> <span class="s1">&#39;NOME&#39;</span><span class="p">,</span> <span class="n">usando</span> <span class="n">o</span> <span class="n">mapa</span> <span class="n">de</span> <span class="n">cores</span> <span class="n">Greens</span><span class="o">.</span> <span class="n">As</span> <span class="n">bordas</span> <span class="n">dos</span> <span class="n">biomas</span> <span class="n">são</span> <span class="n">definidas</span> <span class="n">como</span> <span class="n">pretas</span> <span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span><span class="o">.</span> <span class="n">A</span> <span class="n">legenda</span> <span class="n">é</span> <span class="n">ativada</span> <span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="n">e</span> <span class="n">personalizada</span> <span class="n">usando</span> <span class="n">os</span> <span class="n">argumentos</span> <span class="n">definidos</span> <span class="n">anteriormente</span> <span class="p">(</span><span class="n">legend_kwds</span><span class="o">=</span><span class="n">legend_args</span><span class="p">)</span><span class="o">.</span> <span class="n">Em</span> <span class="n">seguida</span><span class="p">,</span> <span class="n">definimos</span> <span class="n">um</span> <span class="n">título</span> <span class="n">para</span> <span class="n">esse</span> <span class="n">eixo</span><span class="o">.</span>
</pre></div>
</div>
<p>Plotando o mapa das regiões hidrográficas do Brasil no terceiro eixo</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdf_hid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;RHI_NM&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_kwds</span><span class="o">=</span><span class="n">legend_args</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Regiões Hidrográficas do Brasil&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Aqui</span><span class="p">,</span> <span class="n">plotamos</span> <span class="n">o</span> <span class="n">gdf_hid</span> <span class="n">no</span> <span class="n">terceiro</span> <span class="n">eixo</span> <span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="n">e</span> <span class="n">atribuímos</span> <span class="n">cores</span> <span class="k">as</span> <span class="n">regiões</span> <span class="n">hidrográficas</span> <span class="n">com</span> <span class="n">base</span> <span class="n">na</span> <span class="n">coluna</span> <span class="s1">&#39;RHI_NM&#39;</span> <span class="n">usando</span> <span class="n">o</span> <span class="n">mapa</span> <span class="n">de</span> <span class="n">cores</span> <span class="s1">&#39;Blues&#39;</span><span class="o">.</span> <span class="n">As</span> <span class="n">bordas</span> <span class="n">das</span> <span class="n">regiões</span> <span class="n">são</span> <span class="n">definidas</span> <span class="n">como</span> <span class="n">pretas</span> <span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span><span class="o">.</span> <span class="n">A</span> <span class="n">legenda</span> <span class="n">é</span> <span class="n">ativada</span> <span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="n">e</span> <span class="n">personalizada</span> <span class="n">usando</span> <span class="n">os</span> <span class="n">argumentos</span> <span class="n">definidos</span> <span class="n">anteriormente</span> <span class="p">(</span><span class="n">legend_kwds</span><span class="o">=</span><span class="n">legend_args</span><span class="p">)</span><span class="o">.</span> <span class="n">Em</span> <span class="n">seguida</span><span class="p">,</span> <span class="n">definimos</span> <span class="n">um</span> <span class="n">título</span> <span class="n">para</span> <span class="n">esse</span> <span class="n">eixo</span><span class="o">.</span>
</pre></div>
</div>
<p>O restante do código permanece inalterado com relação ao primeiro código apresentado.</p>
<p>6.4 Adicionando Mapas Base à Plotagem com Contextily</p>
<p>Ao visualizar dados geoespaciais, muitas vezes é útil ter um mapa base para fornecer contexto geográfico. A biblioteca Contextily permite adicionar facilmente mapas base, provenientes de fontes populares como OpenStreetMap e Stamen às suas visualizações.
A biblioteca foi projetada para integrar-se perfeitamente com outras bibliotecas geoespaciais, como Geopandas e Matplotlib. Ela é capaz de reprojetar os dados automaticamente para o sistema de coordenadas Web Mercator (EPSG:3857), comumente usado por provedores de tiles de mapas base. Além disso, ao recuperar tiles de mapas base, otimiza o desempenho armazenando-os localmente em cache.</p>
<p>Provedores de mapas base no Contextily</p>
<p>A biblioteca Contextily fornece acesso a vários provedores de tiles de mapas base. Os provedores incluídos no Contextily estão organizados sob o módulo ctx.providers. Cada provedor tem um ou mais estilos de mapa disponíveis. No quadro 15 apresenta-se alguns dos principais provedores e estilos disponíveis com acesso gratuito.</p>
<p>Quadro 15: Provedores de tiles e estilos no Contextily.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Provedor</p></th>
<th class="head"><p>Estilo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>OpenStreetMap</p></td>
<td><p>ctx.providers.OpenStreetMap.Mapnik</p></td>
</tr>
<tr class="row-odd"><td><p>Stamen</p></td>
<td><p>ctx.providers.Stamen.Toner</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>ctx.providers.Stamen.TonerLite</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>ctx.providers.Stamen.Terrain</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>ctx.providers.Stamen.Watercolor</p></td>
</tr>
<tr class="row-odd"><td><p>CartoDB</p></td>
<td><p>ctx.providers.CartoDB.Positron</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>ctx.providers.CartoDB.DarkMatter</p></td>
</tr>
<tr class="row-odd"><td><p>Esri</p></td>
<td><p>ctx.providers.Esri.WorldStreetMap</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>ctx.providers.Esri.DeLorme</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>ctx.providers.Esri.WorldTopoMap</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>ctx.providers.Esri.WorldImagery</p></td>
</tr>
</tbody>
</table>
<p>Abaixo apresentamos alguns exemplos de estilos de mapas base:</p>
<p>OpenStreetMap.Mapnik
Stamen.Watercolor</p>
<p>Esri.DeLorme
NASAGIBS.ASTER_GDEM_
Greyscale_Shaded_Relief</p>
<p>Figura 109: Exemplos de estilos de mapa base disponíveis a partir da Contextily.
Vale lembrar que a disponibilidade dos tiles pode variar dependendo dos termos de serviço dos provedores e da capacidade de suportar tráfego. Além disso, a lista de provedores e estilos pode mudar com o tempo, conforme novos estilos são adicionados ou antigos são removidos. Você pode verificar diretamente a lista completa de provedores e estilos disponíveis no ambiente Python explorando o módulo ctx.providers.</p>
<p>Exemplo:
Criar uma visualização do município de Florianópolis com o basemap WorldImagery, do provedor ESRI.
Inicialmente, precisamos instalar a biblioteca Contextily:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install contextily
</pre></div>
</div>
</div>
</div>
<p>O comando !pip install é utilizado para instalar pacotes Python utilizando o gerenciador de pacotes pip. O prefixo “!“ é específico para ambientes como o Jupyter Notebook e indica que o comando deve ser executado no sistema operacional, e não no kernel Python.
Em seguida, importamos as bibliotecas necessárias, lemos o arquivo shapefile e geramos um plot para ver se o arquivo foi lido corretamente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">contextily</span> <span class="k">as</span> <span class="nn">ctx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Carregar o GeoDataFrame</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/content/floripa.shp&#39;</span><span class="p">)</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">Agora</span> <span class="n">vamos</span> <span class="n">plotar</span> <span class="n">o</span> <span class="n">GeoDataFrame</span> <span class="n">utilizando</span> <span class="n">o</span> <span class="n">Contextily</span><span class="p">:</span>

<span class="c1"># Plotar o GeoDataFrame</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> 
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="c1"># Adicionar o mapa base</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">ctx</span><span class="o">.</span><span class="n">providers</span><span class="o">.</span><span class="n">Esri</span><span class="o">.</span><span class="n">WorldImagery</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Detalhando o código anterior:</p>
<p>ax = gdf.to_crs(epsg=3857).plot(figsize=(15, 15), facecolor=’none’, alpha=0.9, edgecolor=’r’)
Aqui, reprojetamos o GeoDataFrame gdf para o sistema de coordenadas Web Mercator (EPSG:3857), que é comum para mapas base. Em seguida, plotamos com as seguintes características:</p>
<p>figsize=(15, 15): Define o tamanho da figura;
facecolor=’none’: Define a cor de preenchimento das geometrias como ‘sem cor’;
alpha=0.9: Define a transparência das geometrias (0 é totalmente transparente, 1 é totalmente opaco);
edgecolor=’r’: Define a cor das bordas das geometrias como vermelho.</p>
<p>ctx.add_basemap(ax, source=ctx.providers.Esri.WorldImagery, zoom=12)
plt.show()
A biblioteca Contextily é usada para adicionar um mapa base à visualização. Neste caso, o mapa base escolhido é o WorldImagery da Esri. A função add_basemap adiciona esse mapa ao fundo da plotagem de gdf, com um nível de zoom definido como 12. Por fim, plt.show() é utilizado para exibir o gráfico.</p>
<p>6.5 Visualização interativa com folium</p>
<p>O Folium é uma biblioteca que tem como base a biblioteca JavaScript Leaflet.js (<a class="reference external" href="https://leafletjs.com/">https://leafletjs.com/</a>). Sua integração com as bibliotecas Pandas e Geopandas permite transformar DataFrames e GeoDataFrames em visualizações de mapa interativas.
O Folium suporta uma ampla variedade de tiles de mapa, como Mapbox e OpenStreetMap, para que os usuários possam personalizar a aparência de seus mapas base. É possível configurar cores, ícones e estilos para a visualização de dados. Com relação a ícones, o Folium utiliza predominantemente os ícones do FontAwesome 4.7 e os estilos de cores são predefinidos dentro da própria biblioteca. A lista completa de ícones disponíveis pode ser consultada no seguinte link: (<a class="reference external" href="https://fontawesome.com/v4.7/icons/">https://fontawesome.com/v4.7/icons/</a>).
O Folium possui um conjunto predefinido de cores para os ícones. No entanto, ao contrário dos ícones, a lista de cores não está bem documentada em um único lugar, no site oficial ou na documentação do Folium. Algumas das cores disponíveis são: ‘red’, ‘blue’, ‘green’, ‘purple’, ‘orange’, ‘darkred’, ‘lightred’, ‘beige’- ‘darkblue’, ‘darkgreen’, ‘cadetblue’, ‘darkpurple’, ‘white’, ‘pink’, ‘lightblue’, ‘lightgreen’, ‘gray’, ‘black’, ‘lightgray’.
Existem vários plugins que ampliam as funcionalidades do Folium e possibilitam a criação de visualizações de mapas mais interativas e ricas em recursos, como o HeatMap, MarkerCluster, Fullscreen. Além disso, como o Folium é baseado no Leaflet.js, muitos plugins do Leaflet podem ser facilmente adaptados ou integrados a ele.</p>
<p>6.5.1 Aplicando o Folium com dados reais</p>
<p>Vamos demonstrar algumas das funcionalidades do Folium a partir de exemplos com dados reais.</p>
<p>Exemplo 1: Criar uma visualização interativa das localizações das hidrelétricas e PCHs do estado de São Paulo.</p>
<p>Importar as bibliotecas, ler o arquivo shapefile e criar o GeoDataFrame</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">folium</span>
<span class="n">gdf_hsp</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/content/hidreletricas_sp.shp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Calcular a latitude e longitude médias das geometrias no GeoDataFrame</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">latitude_central</span> <span class="o">=</span> <span class="n">gdf_hsp</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">longitude_central</span> <span class="o">=</span> <span class="n">gdf_hsp</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Imprimir as coordenadas centrais</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">latitude_central</span><span class="p">,</span> <span class="n">longitude_central</span><span class="p">)</span>
<span class="c1">#Saída: (-22.6444, -48.0966)</span>
</pre></div>
</div>
</div>
</div>
<p>Inicializar um mapa centrado nas coordenadas médias com um nível de zoom inicial de 7</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mapa_hid</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">latitude_central</span><span class="p">,</span> <span class="n">longitude_central</span><span class="p">],</span> 
    <span class="n">zoom_start</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="c1"># Também é possível inserir manualmente as coordenadas centrais do mapa</span>
<span class="c1"># mapa_hid = folium.Map(location=[-22.6444, -48.0996], zoom_start=7)</span>

<span class="c1"># Adicionar um marcador ao mapa para cada hidrelétrica no GeoDataFrame</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">gdf_hsp</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">folium</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">],</span>
                  <span class="n">popup</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;potenciaou&#39;</span><span class="p">]</span>  
                 <span class="p">)</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">mapa_hid</span><span class="p">)</span>

<span class="c1"># Exibir o mapa </span>
<span class="n">mapa_hid</span>
</pre></div>
</div>
</div>
</div>
<p>Nessa visualização, além de termos a localização dos pontos referentes às hidrelétricas e PCHs, podemos visualizar a capacidade instalada clicando no ícone desejado.</p>
<p>Vamos analisar o código por partes:</p>
<p>latitude_central = gdf_hsp.geometry.y.mean()
longitude_central = gdf_hsp.geometry.x.mean()
print(latitude_central, longitude_central)
#Saída: (-22.6444, -48.0966)</p>
<p>Esse código calcula a latitude e longitude médias de todas as geometrias no GeoDataFrame. Isso é usado para definir o ponto central do mapa que será criado posteriormente.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapa_hid</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">latitude_central</span><span class="p">,</span> <span class="n">longitude_central</span><span class="p">],</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">Um</span> <span class="n">mapa</span> <span class="n">é</span> <span class="n">inicializado</span> <span class="n">usando</span> <span class="n">a</span> <span class="n">biblioteca</span> <span class="n">Folium</span><span class="p">,</span> <span class="n">centrado</span> <span class="n">nas</span> <span class="n">coordenadas</span> <span class="n">médias</span> <span class="n">calculadas</span> <span class="n">anteriormente</span> <span class="n">e</span> <span class="n">com</span> <span class="n">um</span> <span class="n">nível</span> <span class="n">de</span> <span class="n">zoom</span> <span class="n">inicial</span> <span class="n">de</span> <span class="mf">7.</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">gdf_hsp</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">folium</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">],</span>
                  <span class="n">popup</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;potenciaou&#39;</span><span class="p">]</span>  
                 <span class="p">)</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">mapa_hid</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Para</span> <span class="n">cada</span> <span class="n">hidrelétrica</span> <span class="n">no</span> <span class="n">GeoDataFrame</span> <span class="n">gdf_hsp</span><span class="p">,</span> <span class="n">um</span> <span class="n">marcador</span> <span class="n">é</span> <span class="n">adicionado</span> <span class="n">ao</span> <span class="n">mapa</span><span class="o">.</span> <span class="n">A</span> <span class="n">localização</span> <span class="n">de</span> <span class="n">cada</span> <span class="n">marcador</span> <span class="n">é</span> <span class="n">definida</span> <span class="n">pela</span> <span class="n">latitude</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="n">e</span> <span class="n">longitude</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="n">da</span> <span class="n">hidrelétrica</span><span class="o">.</span> <span class="n">Um</span> <span class="n">pop</span><span class="o">-</span><span class="n">up</span> <span class="n">também</span> <span class="n">é</span> <span class="n">adicionado</span> <span class="n">a</span> <span class="n">cada</span> <span class="n">marcador</span><span class="p">,</span> <span class="n">que</span> <span class="n">exibirá</span> <span class="n">a</span> <span class="n">potência</span> <span class="n">da</span> <span class="n">hidrelétrica</span> <span class="n">quando</span> <span class="n">o</span> <span class="n">marcador</span> <span class="k">for</span> <span class="n">clicado</span><span class="o">.</span> <span class="n">Para</span> <span class="n">alvar</span> <span class="n">a</span> <span class="n">visualização</span> <span class="n">interativa</span> <span class="n">em</span> <span class="n">um</span> <span class="n">arquivo</span> <span class="n">HTML</span><span class="p">:</span>
<span class="n">mapa_hid</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;mapa_hidreletricas_SP.html&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Vamos agora gerar uma nova visualização, alterando o mapa base e o símbolo dos marcadores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inicializando um mapa folium centrado na latitude e longitude médias</span>

<span class="c1"># usar o serviço de imagens do ArcGIS como tiles de fundo</span>
<span class="n">mapa_hid</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">latitude_central</span><span class="p">,</span> <span class="n">longitude_central</span><span class="p">],</span>  <span class="c1"># Ponto central do mapa</span>
    <span class="n">zoom_start</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>  <span class="c1"># Nível de zoom inicial</span>
    <span class="n">control_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Adiciona um controle de escala ao mapa</span>
    <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;ESRI World Imagery&#39;</span><span class="p">,</span>  <span class="c1"># Atribuição do mapa</span>
    <span class="n">tiles</span><span class="o">=</span>
    <span class="s1">&#39;http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/</span><span class="si">{z}</span><span class="s1">/</span><span class="si">{y}</span><span class="s1">/</span><span class="si">{x}</span><span class="s1">&#39;</span>  <span class="c1"># URL do servidor de tiles</span>
<span class="p">)</span>

<span class="c1"># Iterar sobre cada linha do GeoDataFrame &#39;gdf_hsp&#39; para adicionar marcadores ao mapa</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">gdf_hsp</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">folium</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
        <span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">],</span>  <span class="c1"># Coordenadas do marcador</span>
        <span class="n">popup</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;potenciaou&#39;</span><span class="p">],</span>  <span class="c1"># Informação da potência que será mostrada no pop-up</span>
        <span class="n">icon</span><span class="o">=</span><span class="n">folium</span><span class="o">.</span><span class="n">Icon</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;flash&#39;</span><span class="p">)</span>  <span class="c1"># Ícone azul com símbolo de &#39;flash&#39;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">mapa_hid</span><span class="p">)</span>  <span class="c1"># Adiciona o marcador ao mapa</span>

<span class="c1"># Exibir o mapa</span>
<span class="n">mapa_hid</span>
</pre></div>
</div>
</div>
</div>
<p>É possível ainda alterar o dimensionamento da área gráfica da figura:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">latitude_central</span><span class="p">,</span> <span class="n">longitude_central</span><span class="p">],</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">control_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Nesse Código, width=600 e height=400 definem as dimensões do mapa em pixels. Neste caso, o mapa terá uma largura de 600 pixels e uma altura de 400 pixels.
</pre></div>
</div>
<p>Exemplo 2: Criar a visualização interativa de uma geometria do tipo ‘linha’: a BR-116.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar as bibliotecas </span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">folium</span>

<span class="c1"># Ler o arquivo shapefile e armazenar no GeoDataFrame</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/content/br116.shp&#39;</span><span class="p">)</span>

<span class="c1"># Calcular o ponto central da união das geometrias no GeoDataFrame</span>
<span class="n">center</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">centroid</span>

<span class="c1"># Obter a latitude e longitude desse ponto central</span>
<span class="n">latitude_central</span> <span class="o">=</span> <span class="n">center</span><span class="o">.</span><span class="n">y</span>
<span class="n">longitude_central</span> <span class="o">=</span> <span class="n">center</span><span class="o">.</span><span class="n">x</span>

<span class="c1"># Converter o GeoDataFrame para formato JSON </span>
<span class="n">gdf</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="n">gdf_json</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

<span class="c1"># Criar um objeto de feature GeoJson a partir do gdf convertido em JSON</span>
<span class="n">gdf_ftrs</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">GeoJson</span><span class="p">(</span><span class="n">gdf_json</span><span class="p">)</span>

<span class="c1"># Inicializar o mapa folium centrado na latitude e longitude calculadas </span>
<span class="c1"># Nível de zoom inicial de 4</span>
<span class="n">mapabr</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">latitude_central</span><span class="p">,</span> <span class="n">longitude_central</span><span class="p">],</span> 
    <span class="n">zoom_start</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Adicionar o GeoJson (que representa a BR-116) ao mapa</span>
<span class="n">mapabr</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">gdf_ftrs</span><span class="p">)</span>

<span class="c1"># Exibir o mapa </span>
<span class="n">Mapabr</span>
</pre></div>
</div>
</div>
</div>
<p>Exemplo 3: Criar uma visualização com os municípios do estado do Amapá (dados do tipo ‘polígono’), introduzindo algumas possibilidades de configuração adicional.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar as bibliotecas necessárias</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">folium</span>

<span class="c1"># Ler o arquivo shapefile e armazenar no GeoDataFrame</span>
<span class="n">amapa</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/content/censo_mun_AP.shp&#39;</span><span class="p">)</span>

<span class="c1"># Calcular o ponto central (centroid) da união de todas as geometrias no GeoDataFrame</span>
<span class="n">center</span> <span class="o">=</span> <span class="n">amapa</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">centroid</span>

<span class="c1"># Obter a latitude e longitude desse ponto central</span>
<span class="n">latitude_central</span> <span class="o">=</span> <span class="n">center</span><span class="o">.</span><span class="n">y</span>
<span class="n">longitude_central</span> <span class="o">=</span> <span class="n">center</span><span class="o">.</span><span class="n">x</span>

<span class="c1"># Converter o GeoDataFrame para formato JSON (útil para visualização em algumas bibliotecas)</span>
<span class="n">amapa</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="n">amapa_json</span> <span class="o">=</span> <span class="n">amapa</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="c1"># Criar um objeto de feature GeoJson a partir do GeoDataFrame convertido em JSON</span>
<span class="n">amapa_ftrs</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">GeoJson</span><span class="p">(</span><span class="n">amapa_json</span><span class="p">)</span>

<span class="c1"># Inicializar um mapa folium centrado na latitude e longitude calculadas com um nível de zoom inicial de 7</span>
<span class="c1"># Utilizar o serviço de imagens do mundo do ArcGIS como tiles de fundo</span>
<span class="n">mapa_AP</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">latitude_central</span><span class="p">,</span> <span class="n">longitude_central</span><span class="p">],</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
        <span class="n">control_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;ESRI World Imagery&#39;</span><span class="p">,</span>
        <span class="n">tiles</span><span class="o">=</span>
        <span class="s1">&#39;http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/</span><span class="si">{z}</span><span class="s1">/</span><span class="si">{y}</span><span class="s1">/</span><span class="si">{x}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Adicionar o GeoJson (que representa os municípios do Amapá) ao mapa</span>
<span class="n">mapa_AP</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">amapa_ftrs</span><span class="p">)</span>

<span class="c1"># Exibir o mapa</span>
<span class="n">mapa_AP</span>
</pre></div>
</div>
</div>
</div>
<p>Vamos alterar o código anterior, especificando a cor e a espessura da linha de borda e a cor de preenchimento dos municípios.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Criar uma função para estilizar as geometrias referentes aos municípios.</span>
<span class="c1"># A função especifica a cor da borda, a espessura da borda e a cor de preenchimento.</span>
<span class="k">def</span> <span class="nf">estilo_mun</span><span class="p">(</span><span class="n">ftr</span><span class="p">):</span>
    <span class="k">return</span><span class="p">({</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;fillColor&#39;</span><span class="p">:</span><span class="s1">&#39;purple&#39;</span><span class="p">})</span>

<span class="c1"># Converter o GeoDataFrame &#39;amapa&#39; para formato JSON.</span>
<span class="n">amapa_json</span> <span class="o">=</span> <span class="n">amapa</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

<span class="c1"># Criar o objeto de feature GeoJson a partir do GeoDataFrame convertido em JSON. E:</span>
<span class="c1"># - Definir o nome da layer como &#39;municipio&#39;.</span>
<span class="c1"># - Adicionar um tooltip que mostra informações dos municípios ao passar o mouse sobre eles.</span>
<span class="c1"># - Aplicar a função de estilo estilo_mun a cada município.</span>
<span class="n">amapa_ftrs</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">GeoJson</span><span class="p">(</span><span class="n">amapa_json</span><span class="p">,</span> 
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;municipio&#39;</span><span class="p">,</span> 
    <span class="n">tooltip</span><span class="o">=</span><span class="n">folium</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">GeoJsonTooltip</span><span class="p">([</span><span class="s1">&#39;municipio&#39;</span><span class="p">,</span> <span class="s1">&#39;pop_2010&#39;</span><span class="p">,</span> <span class="s1">&#39;pop_2021&#39;</span><span class="p">,</span> <span class="s1">&#39;dif_pop&#39;</span><span class="p">]),</span> 
    <span class="n">style_function</span><span class="o">=</span><span class="n">estilo_mun</span><span class="p">)</span>

<span class="c1"># Adicionar o GeoJson ao mapa previamente criado.</span>
<span class="n">mapa_AP</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">amapa_ftrs</span><span class="p">)</span>

<span class="c1"># Exibir o mapa.</span>
<span class="n">mapa_AP</span>
</pre></div>
</div>
</div>
</div>
<p>A partir das alterações realizadas no código, é possível visualizar as geometrias referentes aos municípios do estado do Amapá com outra configuração. Além disso, podemos verificar os dados sobre a população em 2010 e 2021 e a sua alteração (em porcentagem):</p>
<p>É possível criar estilos de visualização diferentes, com base na seleção de propriedades ou atributos. Nesse exemplo, vamos criar uma função que verifica o nome do município e, se for ‘Macapá’, aplica estilo específico. Caso contrário, aplica um estilo padrão para os outros municípios. O resultado pode ser visualizado na figura 119.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">estilo_mun</span><span class="p">(</span><span class="n">ftr</span><span class="p">):</span>
    <span class="c1"># Verificar se o município é &#39;Macapá&#39;</span>
    <span class="k">if</span> <span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;municipio&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Macapá&#39;</span><span class="p">:</span>
        <span class="c1"># Estilo para o município &#39;Macapá&#39;  </span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;fillColor&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">}</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Estilo padrão para os outros municípios</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;fillColor&#39;</span><span class="p">:</span><span class="s1">&#39;purple&#39;</span><span class="p">}</span> 

<span class="n">amapa_json</span> <span class="o">=</span> <span class="n">amapa</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

<span class="n">amapa_ftrs</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">GeoJson</span><span class="p">(</span><span class="n">amapa_json</span><span class="p">,</span> 
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;municipio&#39;</span><span class="p">,</span> 
    <span class="n">tooltip</span><span class="o">=</span><span class="n">folium</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">GeoJsonTooltip</span><span class="p">([</span><span class="s1">&#39;municipio&#39;</span><span class="p">,</span> <span class="s1">&#39;pop_2010&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;pop_2021&#39;</span><span class="p">,</span> <span class="s1">&#39;dif_pop&#39;</span><span class="p">]),</span> 
    <span class="n">style_function</span><span class="o">=</span><span class="n">estilo_mun</span><span class="p">)</span>

<span class="n">mapa_AP</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">amapa_ftrs</span><span class="p">)</span>
<span class="n">mapa_AP</span>
</pre></div>
</div>
</div>
</div>
<p>No próximo exemplo, vamos aplicar um estilo com cor de preenchimento aleatória a cada município do Amapá, enquanto a cor de borda e a espessura serão as mesmas para todos. O resultado pode ser visualizado na figura 120.</p>
<p>Importar o módulo random, que permite fazer escolhas aleatórias</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># Definir uma função para estilizar as geometrias (municípios) no mapa.</span>
<span class="c1"># A cor de preenchimento de cada município é determinada aleatoriamente </span>
<span class="c1"># a partir de uma lista de cores.</span>
<span class="k">def</span> <span class="nf">estilo_mun</span><span class="p">(</span><span class="n">ftr</span><span class="p">):</span>
    <span class="c1"># Definir uma lista de cores que podem ser escolhidas.</span>
    <span class="n">cores</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;violet&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;indigo&#39;</span><span class="p">]</span>
    
    <span class="c1"># Retornar o estilo para o município. A cor de preenchimento é selecionada </span>
    <span class="c1"># aleatoriamente. A cor de contorno é definida como preta e a espessura do </span>
    <span class="c1"># contorno como 2.</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;fillColor&#39;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">cores</span><span class="p">)}</span>

<span class="n">amapa_json</span> <span class="o">=</span> <span class="n">amapa</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="n">amapa_ftrs</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">GeoJson</span><span class="p">(</span>
    <span class="n">amapa_json</span><span class="p">,</span> 
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;municipio&#39;</span><span class="p">,</span> 
    <span class="n">tooltip</span><span class="o">=</span><span class="n">folium</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">GeoJsonTooltip</span><span class="p">([</span><span class="s1">&#39;municipio&#39;</span><span class="p">,</span> <span class="s1">&#39;pop_2010&#39;</span><span class="p">,</span> <span class="s1">&#39;pop_2021&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;dif_pop&#39;</span><span class="p">]),</span> 
    <span class="n">style_function</span><span class="o">=</span><span class="n">estilo_mun</span>
<span class="p">)</span>

<span class="n">mapa_AP</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">amapa_ftrs</span><span class="p">)</span>
<span class="n">mapa_AP</span>
</pre></div>
</div>
</div>
</div>
<p>Por fim, vamos gerar um mapa interativo (figura 121) que mostra os municípios do estado do Amapá e as estações fluviométricas da Agência Nacional de Águas (ANA), com estilizações e tooltips específicos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Carregar o shapefile que contém informações sobre as estações </span>
<span class="c1"># fluviométricas da ANA</span>
<span class="n">ANA</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/content/ANA_estacoes.shp&#39;</span><span class="p">)</span>

<span class="c1"># Definir uma função para estilizar as geometrias dos municípios.</span>
<span class="k">def</span> <span class="nf">estilo_mun</span><span class="p">(</span><span class="n">ftr</span><span class="p">):</span>
    <span class="c1"># Retornar o estilo que será aplicado aos municípios.</span>
    <span class="k">return</span><span class="p">({</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;fillColor&#39;</span><span class="p">:</span><span class="s1">&#39;purple&#39;</span><span class="p">})</span>

<span class="n">amapa_json</span> <span class="o">=</span> <span class="n">amapa</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="n">amapa_ftrs</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">GeoJson</span><span class="p">(</span>
    <span class="n">amapa_json</span><span class="p">,</span> 
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;municipio&#39;</span><span class="p">,</span> 
    <span class="n">tooltip</span><span class="o">=</span><span class="n">folium</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">GeoJsonTooltip</span><span class="p">([</span><span class="s1">&#39;municipio&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;pop_2010&#39;</span><span class="p">,</span> <span class="s1">&#39;pop_2021&#39;</span><span class="p">,</span> <span class="s1">&#39;dif_pop&#39;</span><span class="p">]),</span> 
    <span class="n">style_function</span><span class="o">=</span><span class="n">estilo_mun</span><span class="p">)</span>

<span class="n">ANA_json</span> <span class="o">=</span> <span class="n">ANA</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

<span class="c1"># Criar uma camada GeoJson para as estações fluviométricas da ANA.</span>
<span class="c1"># Tooltips são adicionadas para mostrar informações adicionais sobre </span>
<span class="c1"># uma estação.</span>
<span class="n">ANA_ftrs</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">GeoJson</span><span class="p">(</span>
    <span class="n">ANA_json</span><span class="p">,</span> 
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Estações fluviométricas ANA&#39;</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="n">folium</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">GeoJsonTooltip</span><span class="p">([</span><span class="s1">&#39;Codigo&#39;</span><span class="p">,</span> <span class="s1">&#39;Rios&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Operador&#39;</span><span class="p">]))</span>

<span class="c1"># Inicializar um mapa interativo do Folium. # Definir a localização </span>
<span class="c1"># central e o zoom. O mapa também usará tiles de imagens da ESRI.</span>
<span class="n">mapa_AP</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">latitude_central</span><span class="p">,</span> <span class="n">longitude_central</span><span class="p">],</span> 
    <span class="n">zoom_start</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">control_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;ESRI World Imagery&#39;</span><span class="p">,</span> 
    <span class="n">tiles</span><span class="o">=</span>
    <span class="s1">&#39;http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/</span><span class="si">{z}</span><span class="s1">/</span><span class="si">{y}</span><span class="s1">/</span><span class="si">{x}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Adicionando a camada de municípios ao mapa.</span>
<span class="n">mapa_AP</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">amapa_ftrs</span><span class="p">)</span>

<span class="c1"># Adicionando a camada de estações fluviométricas da ANA ao mapa.</span>
<span class="n">mapa_AP</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">ANA_ftrs</span><span class="p">)</span>

<span class="c1"># Exibindo o mapa.</span>
<span class="n">mapa_AP</span>
</pre></div>
</div>
</div>
</div>
<p>Nesta visualização interativa, podemos verificar tanto dados referentes à população dos municípios (figura 122) quanto dados das estações da ANA (figura 123).</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="capitulo5.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">5 A BIBLIOTECA GEOPANDAS</p>
      </div>
    </a>
    <a class="right-next"
       href="referencias.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">&lt;no title&gt;</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Primeiro subplot (superior esquerdo)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#segundo-subplot-superior-direito">Segundo subplot (superior direito)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#terceiro-subplot-inferior-esquerdo">Terceiro subplot (inferior esquerdo)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quarto-subplot-inferior-direito">Quarto subplot (inferior direito)</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alexandro Gularte Schafer
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>