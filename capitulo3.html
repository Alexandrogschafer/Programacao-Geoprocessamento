

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>3. A BIBLIOTECA PANDAS &#8212; Programação para Geoprocessamento</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'capitulo3';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. GEOPROCESSAMENTO BÁSICO COM SHAPELY E FIONA" href="capitulo4.html" />
    <link rel="prev" title="2. FUNDAMENTOS DA LINGUAGEM PYTHON" href="capitulo2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/pythongeo.png" class="logo__image only-light" alt="Programação para Geoprocessamento - Home"/>
    <script>document.write(`<img src="_static/pythongeo.png" class="logo__image only-dark" alt="Programação para Geoprocessamento - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Programação para Geoprocessamento
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="capitulo1.html">1. INTRODUÇÃO</a></li>
<li class="toctree-l1"><a class="reference internal" href="capitulo2.html">2. FUNDAMENTOS DA LINGUAGEM PYTHON</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. A BIBLIOTECA PANDAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="capitulo4.html">4. GEOPROCESSAMENTO BÁSICO COM SHAPELY E FIONA</a></li>
<li class="toctree-l1"><a class="reference internal" href="capitulo5.html">5 A BIBLIOTECA GEOPANDAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="capitulo6.html">6. VISUALIZAÇÃO DE DADOS GEOESPACIAIS NO PYTHON</a></li>
<li class="toctree-l1"><a class="reference internal" href="referencias.html">REFERÊNCIAS BIBLIOGRÁFICAS</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/alexandrogschafer/Programacao-Geoprocessamento" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/alexandrogschafer/Programacao-Geoprocessamento/issues/new?title=Issue%20on%20page%20%2Fcapitulo3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/capitulo3.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3. A BIBLIOTECA PANDAS</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducao-e-configuracoes-basicas">3.1 Introdução e Configurações Básicas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuracoes-iniciais">3.1.1 Configurações iniciais</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introducao-as-estruturas-de-dados-no-pandas">3.1.2 Introdução às estruturas de dados no Pandas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#criacao-e-manipulacao-de-series">3.1.3 Criação e manipulação de Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#criacao-de-dataframes">3.1.4 Criação de DataFrames</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulacao-e-selecao-de-dados">3.2 Manipulação e Seleção de Dados</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecao-e-filtragem-em-dataframes">3.2.1 Seleção e filtragem em DataFrames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulacao-de-dados-em-dataframes">3.2.2 Manipulação de Dados em DataFrames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulacao-de-indices">3.2.3 Manipulação de índices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operacoes-aritmeticas-com-dataframes">3.2.4 Operações aritméticas com DataFrames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tratamento-de-dados-ausentes-ou-faltantes">3.2.5 Tratamento de dados ausentes ou faltantes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agrupamento-e-agregacao-de-dados">3.2.6 Agrupamento e Agregação de Dados</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importacao-e-exportacao-de-dados">3.3 Importação e exportação de dados</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arquivos-csv-comma-separated-values">3.3.1 Arquivos CSV (Comma-Separated Values)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arquivos-do-excel">3.3.2 Arquivos do Excel</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gravacao-de-dados-em-diferentes-formatos">3.3.3 Gravação de dados em diferentes formatos</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="a-biblioteca-pandas">
<h1>3. A BIBLIOTECA PANDAS<a class="headerlink" href="#a-biblioteca-pandas" title="Permalink to this heading">#</a></h1>
<p>Pandas é uma biblioteca de programação em Python que fornece estruturas de dados e ferramentas de análise de dados flexíveis e eficientes. É uma das bibliotecas mais populares e amplamente utilizadas para análise e manipulação de dados em Python. Ele transforma a complexidade da manipulação de dados em tarefas intuitivas, permitindo que o usuário se concentre na análise dos dados ao invés de se preocupar com os aspectos técnicos da preparação de dados. Constituem pontos-chave do Pandas:</p>
<p>Estruturas de Dados: O Pandas introduz duas estruturas de dados principais para Python: Series e DataFrame;</p>
<p>Manipulação de Dados: Facilita a filtragem seleção, mesclagem e agrupamento de dados. Disponibiliza ainda funções e métodos para efetuar rapidamente operações comuns, como: Manipulação de datas; Ajuste de dados faltantes; Agrupamento e agregação de dados; Fusão e junção de conjuntos de dados;</p>
<p>Análise de Dados: Facilita a análise estatística dos dados. Ele integra-se bem com outras bibliotecas de análise de dados e visualização, como numpy, scipy e matplotlib;</p>
<p>Importação e Exportação de Dados: Suporta uma ampla variedade de formatos de arquivos, como CSV, Excel, SQL, HDF5, entre outros. Isso torna fácil importar dados para análise e exportar resultados após a análise;</p>
<p>Integração: integra-se bem com muitas outras bibliotecas do ecossistema de ciência de dados em Python, como matplotlib para visualização, scikit-learn para aprendizado de máquina e statsmodels para modelagem estatística.</p>
<section id="introducao-e-configuracoes-basicas">
<h2>3.1 Introdução e Configurações Básicas<a class="headerlink" href="#introducao-e-configuracoes-basicas" title="Permalink to this heading">#</a></h2>
<section id="configuracoes-iniciais">
<h3>3.1.1 Configurações iniciais<a class="headerlink" href="#configuracoes-iniciais" title="Permalink to this heading">#</a></h3>
<p>Ao iniciar com a biblioteca Pandas, é importante realizar algumas configurações iniciais para garantir que a experiência de análise de dados seja otimizada e alinhada às suas preferências. Abaixo, apresento algumas configurações comuns que os usuários do Pandas frequentemente ajustam:</p>
<p>Importação da Biblioteca: Antes de qualquer coisa, você precisa importar a biblioteca. Pandas é geralmente importado com o alias “pd” por convenção.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>Configuração do número máximo de linhas e colunas exibidas: Se você estiver trabalhando com DataFrames grandes, pode querer ajustar o número de linhas e colunas exibidas por padrão quando imprimir o DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Largura da Coluna e Precisão: Para melhor visualização dos dados, você pode ajustar a largura da coluna e a precisão (número de casas decimais).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.precision&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Configuração do Float Format: Controla a formatação de números flutuantes. Útil para quando se quer mostrar valores em formato de porcentagem, por exemplo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
</pre></div>
</div>
</div>
</div>
<p>Evitando Notação Científica: Por padrão, o Pandas pode exibir números grandes ou muito pequenos usando notação científica. Para desativar isso:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Configurações de Visualização: Se estiver usando o Jupyter Notebook ou Jupyter Lab, para que os plots feitos com Pandas (integrados com Matplotlib) sejam exibidos diretamente no notebook:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>Configuração de Data e Hora: Se estiver trabalhando com séries temporais, pode ser útil ajustar a formatação padrão de datas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.date_dayfirst&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Configuração do Encoding Padrão: Ao lidar com conjuntos de dados que possuem caracteres especiais ou não-ASCII, configurar o encoding padrão para leitura e escrita de arquivos pode evitar problemas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.encoding&#39;</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Estas são apenas algumas das opções que você pode configurar ao iniciar com o Pandas. Dependendo da natureza de seus dados e suas preferências pessoais, você pode precisar ajustar outras opções. Consulte a documentação do Pandas para uma lista completa de opções configuráveis.</p>
</section>
<section id="introducao-as-estruturas-de-dados-no-pandas">
<h3>3.1.2 Introdução às estruturas de dados no Pandas<a class="headerlink" href="#introducao-as-estruturas-de-dados-no-pandas" title="Permalink to this heading">#</a></h3>
<p>O domínio das estruturas de dados do Pandas é essencial para qualquer pessoa que deseja trabalhar com análise de dados em Python. Uma vez que você esteja confortável com Series e DataFrame, muitas tarefas complexas de processamento de dados se tornarão mais simples e diretas.</p>
<p>No contexto da biblioteca Pandas, quando falamos de estruturas de dados, nos referimos principalmente a duas estruturas fundamentais: a Series e o DataFrame, que são a base para a maioria das operações de análise de dados em Python. Ambas foram projetadas para facilitar a manipulação de dados em Python, cada uma servindo a diferentes propósitos e possuindo suas características específicas.</p>
<p>Além de Series e DataFrame, o Pandas oferece outras estruturas mais especializadas como Panel (estrutura tridimensional, menos usada) e MultiIndex (para indexação hierárquica).</p>
<p>Series</p>
<p>Series é uma estrutura de dados unidimensional, que pode armazenar valores de qualquer tipo de dado (números, strings, objetos Python, etc.). É, em essência, uma coluna em um DataFrame. Os rótulos dos eixos são chamados de índice.</p>
<p>Uma Series oferece uma variedade de métodos e operações para facilitar a manipulação e análise de dados unidimensionais.</p>
<p>Características Principais:</p>
<p>Unidimensionalidade: Series contém uma sequência de itens em uma única dimensão;</p>
<p>Index: Cada elemento em uma Series é associado a um índice. Esse índice é, por padrão, uma sequência numérica começando por zero, mas pode ser de outros tipos, como datas, strings ou até mesmo outros números;</p>
<p>Homogeneidade: Apesar de uma Series poder conter qualquer tipo de dado, todos os itens em uma única Series devem ser do mesmo tipo. Se diferentes tipos são colocados em uma Series, ela tentará converter os tipos para um formato comum;</p>
<p>Nome: Uma Series pode ter um atributo nome, o que pode ser útil especialmente quando a Series é usada como uma coluna em um DataFrame.</p>
<p>Usos Comuns:</p>
<p>Seleção de dados: Muitas vezes, quando você seleciona uma única coluna de um DataFrame, o resultado é uma Series;</p>
<p>Operações aritméticas: Assim como com arrays do Numpy, é possível realizar operações aritméticas com uma Series;</p>
<p>Operações de agregação: Você pode aplicar funções de agregação, como soma, média, mediana, entre outras, diretamente a uma Series;
Filtragem: É fácil filtrar dados em uma Series usando operadores condicionais;</p>
<p>Aplicação de funções: O método .apply() permite que você aplique uma função a cada item de uma Series.</p>
<p>Conversão de tipos: Converta os tipos de dados em uma Series usando o método astype();</p>
<p>Manipulação de strings: Se a Series contém strings, o Pandas oferece um conjunto robusto de operações de string através do atributo .str;</p>
<p>Tratamento de valores faltantes: Métodos como .fillna() ou .dropna() ajudam a lidar com valores faltantes (NaN) em uma Series.</p>
<p>DataFrame</p>
<p>Um DataFrame é uma estrutura de dados bidimensional, semelhante a uma planilha ou uma tabela de banco de dados, uma planilha do Excel ou uma tabela em linguagens estatísticas como R, que pode armazenar dados de diferentes tipos em suas colunas. O DataFrame é a estrutura central do Pandas e é a ferramenta de escolha para a maioria das operações de análise de dados em Python. Seu design flexível e a grande quantidade de métodos e funcionalidades o tornam ideal para trabalhar com dados em muitos contextos diferentes. Enquanto a Series é essencial e útil em muitos cenários, o DataFrame amplia essa utilidade para operações mais complexas e análises multidimensionais.</p>
<p>Características Principais:</p>
<p>Bidimensionalidade: Ao contrário da Series (unidimensional), um DataFrame é bidimensional, representando dados em linhas e colunas;
Colunas com Nomes: Cada coluna em um DataFrame tem um nome, que serve como seu identificador;</p>
<p>Indexação: Assim como a Series, o DataFrame tem um índice que identifica cada linha. Esse índice pode ser numérico, de data, de string, ou até mesmo hierárquico;</p>
<p>Colunas com diferentes tipos de dados: Enquanto uma Series deve ter um tipo de dado único, um DataFrame pode ter diferentes tipos de dados em suas diferentes colunas (por exemplo, inteiros, floats, strings);</p>
<p>Flexibilidade: Você pode adicionar ou remover colunas, alterar o índice, reordenar as linhas, entre outras operações;
Funcionalidades: O Pandas oferece uma ampla gama de funções e métodos para manipular, filtrar, agrupar, transformar e analisar os dados em um DataFrame;</p>
<p>Integração com Outras Bibliotecas: DataFrames podem ser facilmente convertidos para outras estruturas de dados, como arrays do numpy, e são amplamente utilizados em conjunto com outras bibliotecas de análise de dados e visualização, como matplotlib, seaborn e scikit-learn;</p>
<p>Importação e Exportação: Com o Pandas, é possível ler dados de diversas fontes, como arquivos CSV, Excel, bancos de dados SQL e muitos outros formatos, diretamente para um DataFrame. Da mesma forma, os dados em um DataFrame podem ser facilmente exportados para esses formatos.</p>
<p>Usos Comuns:</p>
<p>Manipulação de dados: Seleção, adição e exclusão de colunas e linhas;</p>
<p>Agrupamento: Utilizando o método groupby() é possível agrupar dados com base em certos critérios e aplicar funções de agregação;
Mesclagem e junção: Com métodos como merge() e join(), é possível combinar diferentes DataFrames de acordo com critérios específicos;
Pivotamento: Transforme dados de formato longo para largo e vice-versa usando métodos como pivot();</p>
<p>Visualização: O Pandas integra-se bem com bibliotecas de visualização, como Matplotlib, permitindo a criação de gráficos diretamente de um DataFrame;</p>
<p>Estatísticas e análise: Calcule estatísticas básicas, realize testes estatísticos, explore correlações e muito mais;
Tratamento de valores faltantes: Use métodos como fillna(), dropna(), e interpolate() para tratar dados faltantes.</p>
<p>Diferenças em Relação às Series:</p>
<p>Dimensionalidade: Enquanto uma Series é unidimensional, o DataFrame é bidimensional;</p>
<p>Tipos de dados: A Series tem um único tipo de dado para todos os seus elementos, enquanto um DataFrame pode ter colunas com diferentes tipos de dados;</p>
<p>Acessibilidade: Em uma Series, acessamos os dados pelo índice. Em um DataFrame, usamos o nome da coluna (ou uma lista de nomes de colunas) para selecionar colunas específicas;</p>
<p>Estrutura: Enquanto você pode pensar em uma Series como uma única coluna de dados com índices, um DataFrame é como um conjunto de Series que compartilham um índice comum.</p>
</section>
<section id="criacao-e-manipulacao-de-series">
<h3>3.1.3 Criação e manipulação de Series<a class="headerlink" href="#criacao-e-manipulacao-de-series" title="Permalink to this heading">#</a></h3>
<p>A criação e a manipulação de Series é um aspecto importante da análise de dados, pois nos permite organizar e trabalhar com sequências de dados de maneira sistemática. Vamos aprender sobre as algumas das ferramentas e técnicas fundamentais para gerenciar e analisar dados em séries.</p>
<p>Criação de uma Series a partir de uma lista</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>A coluna esquerda é o índice da Series (lembre-se que a indexação no Python começa em zero), enquanto a coluna a direita armazena os valores definidos pelo usuário.</p>
<p>Definindo um índice personalizado</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Acessando valores e índices</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">values</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 2, 3, 4, 5])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">index</span>   
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Operações aritméticas básicas</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">+</span> <span class="mi">10</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    11
b    12
c    13
d    14
e    15
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">*</span> <span class="mi">2</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a     2
b     4
c     6
d     8
e    10
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Indexação e Seleção</p>
<p>Seleção por índice</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Seleção por posição</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Seleção condicional</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">]</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c    3
d    4
e    5
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Fatiamento</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b    2
c    3
d    4
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">]</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    1
b    2
c    3
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Atribuição de valores</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>  
</pre></div>
</div>
</div>
</div>
</section>
<section id="criacao-de-dataframes">
<h3>3.1.4 Criação de DataFrames<a class="headerlink" href="#criacao-de-dataframes" title="Permalink to this heading">#</a></h3>
<p>O Pandas facilita a criação de DataFrames a partir de diferentes formatos de dados. Seja um arquivo CSV, uma planilha do Excel, um banco de dados ou até mesmo uma API, o Pandas oferece funcionalidades para transformar essas diversas fontes de informação em estruturas de dados organizadas. Internamente, é possível criar DataFrames a partir de tipos básicos de dados e estruturas de dados. Vamos ver alguns exemplos:</p>
<p>Criação de DataFrame a partir de um dicionário:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">dados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Nome&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Ana&#39;</span><span class="p">,</span> <span class="s1">&#39;Bruno&#39;</span><span class="p">,</span> <span class="s1">&#39;Carlos&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Idade&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">],</span>
    <span class="s1">&#39;Cidade&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Curitiba&#39;</span><span class="p">,</span> <span class="s1">&#39;Belém&#39;</span><span class="p">,</span> <span class="s1">&#39;Belo Horizonte&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dados</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nome</th>
      <th>Idade</th>
      <th>Cidade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ana</td>
      <td>25</td>
      <td>Curitiba</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bruno</td>
      <td>30</td>
      <td>Belém</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Carlos</td>
      <td>35</td>
      <td>Belo Horizonte</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Neste código, primeiro é realizada a importação da biblioteca Pandas com o apelido “pd”. Em seguida, é criado um dicionário chamado “dados”, contendo três pares chave-valor que representam, respectivamente, nomes, idades e cidades de três indivíduos. Por fim, o dicionário é convertido em um DataFrame do Pandas e armazenado na variável “df”. Assim, o DataFrame “df” organiza as informações presentes no dicionário “dados” em forma de tabela, facilitando análises e manipulações posteriores dos dados.</p>
<p>Criação de um DataFrame a partir de uma lista:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nome</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Ana&#39;</span><span class="p">,</span> <span class="s1">&#39;Bruno&#39;</span><span class="p">,</span> <span class="s1">&#39;Carlos&#39;</span><span class="p">]</span>
<span class="n">idade</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">]</span>
<span class="n">cidade</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Curitiba&#39;</span><span class="p">,</span> <span class="s1">&#39;Belém&#39;</span><span class="p">,</span> <span class="s1">&#39;Belo Horizonte&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">nome</span><span class="p">,</span> <span class="n">idade</span><span class="p">,</span> <span class="n">cidade</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Nome&#39;</span><span class="p">,</span> <span class="s1">&#39;Idade&#39;</span><span class="p">,</span> <span class="s1">&#39;Cidade&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Neste código, são definidas três listas: “nome”, “idade” e “cidade”, que contêm, respectivamente, os nomes, idades e cidades de três indivíduos. A função zip é usada para agrupar os elementos correspondentes dessas três listas em tuplas. A função list converte o resultado do zip em uma lista de tuplas, onde cada tupla contém um nome, uma idade e uma cidade. Finalmente, essa lista de tuplas é convertida em um DataFrame, com as colunas nomeadas como ‘Nome’, ‘Idade’ e ‘Cidade’. O resultado é armazenado na variável “df”.</p>
<p>Criação de DataFrames a partir de arquivos:</p>
<p>No contexto do Geoprocessamento, frequentemente lidamos com vastas quantidades de informações armazenadas em diferentes formatos de arquivos, como CSV, Excel, entre outros. A criação de DataFrames a partir de arquivos permite acessar, visualizar e trabalhar com os dados de uma maneira mais organizada e intuitiva. Veremos como criar DataFrames a partir de arquivos externos mais adiante em nosso curso.</p>
</section>
</section>
<section id="manipulacao-e-selecao-de-dados">
<h2>3.2 Manipulação e Seleção de Dados<a class="headerlink" href="#manipulacao-e-selecao-de-dados" title="Permalink to this heading">#</a></h2>
<section id="selecao-e-filtragem-em-dataframes">
<h3>3.2.1 Seleção e filtragem em DataFrames<a class="headerlink" href="#selecao-e-filtragem-em-dataframes" title="Permalink to this heading">#</a></h3>
<p>Ao trabalhar com DataFrames no Pandas, uma habilidade importante é a capacidade de selecionar e filtrar dados de forma eficaz. Dado que um DataFrame pode conter grandes quantidades de dados, frequentemente precisamos isolar subconjuntos específicos desses dados para análises mais detalhadas ou operações subsequentes. Seja para extrair colunas específicas, selecionar linhas baseadas em critérios definidos ou combinar ambos os métodos, o Pandas oferece uma variedade de ferramentas intuitivas que tornam essas tarefas simples e diretas.</p>
<p>Estudaremos a seleção e a filtragem de dados no Pandas a partir de exemplos. Vamos começar criando um conjunto de dados (DataFrame):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;País&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Brasil&#39;</span><span class="p">,</span> <span class="s1">&#39;Argentina&#39;</span><span class="p">,</span> <span class="s1">&#39;Chile&#39;</span><span class="p">,</span> <span class="s1">&#39;Uruguai&#39;</span><span class="p">,</span> <span class="s1">&#39;Paraguai&#39;</span><span class="p">,</span> <span class="s1">&#39;Bolívia&#39;</span><span class="p">],</span>
    <span class="s1">&#39;População&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">211050000</span><span class="p">,</span> <span class="mi">45195777</span><span class="p">,</span> <span class="mi">19116201</span><span class="p">,</span> <span class="mi">3473727</span><span class="p">,</span> <span class="mi">7044636</span><span class="p">,</span> <span class="mi">11513100</span><span class="p">],</span>
    <span class="s1">&#39;Área&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8515767</span><span class="p">,</span> <span class="mi">2780400</span><span class="p">,</span> <span class="mi">756102</span><span class="p">,</span> <span class="mi">176215</span><span class="p">,</span> <span class="mi">406752</span><span class="p">,</span> <span class="mi">1098581</span><span class="p">],</span>  <span class="c1"># em km^2</span>
    <span class="s1">&#39;PIB (2020)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.055</span><span class="p">,</span> <span class="mf">0.389</span><span class="p">,</span> <span class="mf">0.282</span><span class="p">,</span> <span class="mf">0.056</span><span class="p">,</span> <span class="mf">0.038</span><span class="p">,</span> <span class="mf">0.034</span><span class="p">]</span>  <span class="c1"># PIB em </span>
    <span class="c1"># trilhões de dólares para 2020 (valores aproximados)</span>
<span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exibindo o DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        País  População     Área  PIB (2020)
0     Brasil  211050000  8515767        2.06
1  Argentina   45195777  2780400        0.39
2      Chile   19116201   756102        0.28
3    Uruguai    3473727   176215        0.06
4   Paraguai    7044636   406752        0.04
5    Bolívia   11513100  1098581        0.03
</pre></div>
</div>
</div>
</div>
<p>Selecionar colunas e linhas específicas</p>
<p>Para selecionar uma única coluna, você pode usar a notação de colchetes com o nome da coluna.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Selecionando apenas a coluna &#39;País&#39;</span>
<span class="n">paises</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;País&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">paises</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       Brasil
1    Argentina
2        Chile
3      Uruguai
4     Paraguai
5      Bolívia
Name: País, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Para selecionar várias colunas, você pode passar uma lista com os nomes das colunas desejadas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Selecionando as colunas &#39;País&#39; e &#39;PIB (2020)&#39;</span>
<span class="n">paises_pib</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;País&#39;</span><span class="p">,</span> <span class="s1">&#39;PIB (2020)&#39;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">paises_pib</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        País  PIB (2020)
0     Brasil        2.06
1  Argentina        0.39
2      Chile        0.28
3    Uruguai        0.06
4   Paraguai        0.04
5    Bolívia        0.03
</pre></div>
</div>
</div>
</div>
<p>Usando o método .iloc:</p>
<p>O método iloc do Pandas permite selecionar linhas e colunas em um DataFrame usando índices numéricos. É uma abordagem baseada em posição, o que significa que você se refere às linhas e colunas por seus índices numéricos.</p>
<p>Para selecionar uma única linha, você pode usar a notação de colchetes com o índice da linha.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Selecionando a terceira linha (índice 2)</span>
<span class="n">linha3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">linha3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>País             Chile
População     19116201
Área            756102
PIB (2020)        0.28
Name: 2, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Você pode selecionar várias linhas passando uma lista de índices ou um intervalo de índices. Por exemplo, selecionar as três primeiras linhas do DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">primeiras_tres</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">primeiras_tres</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        País  População     Área  PIB (2020)
0     Brasil  211050000  8515767        2.06
1  Argentina   45195777  2780400        0.39
2      Chile   19116201   756102        0.28
</pre></div>
</div>
</div>
</div>
<p>Para selecionar linhas com índices específicos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linhas_especificas</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">linhas_especificas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        País  População     Área  PIB (2020)
1  Argentina   45195777  2780400        0.39
3    Uruguai    3473727   176215        0.06
5    Bolívia   11513100  1098581        0.03
</pre></div>
</div>
</div>
</div>
<p>Selecionando Linhas e Colunas Simultaneamente</p>
<p>Com iloc, você também pode selecionar linhas e colunas específicas ao mesmo tempo. Para selecionar uma coluna específica utilizando o método iloc, é necessário fornecer os índices das linhas e da coluna desejada. Se você deseja selecionar toda a coluna “País”, por exemplo, pode fazer o seguinte:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coluna_pais</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coluna_pais</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       Brasil
1    Argentina
2        Chile
3      Uruguai
4     Paraguai
5      Bolívia
Name: País, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Neste código, <code class="docutils literal notranslate"><span class="pre">df.iloc[:,</span> <span class="pre">0]</span></code> seleciona todas as linhas (indicado pelo “:”) da primeira coluna (índice 0).</p>
<p>Se você quiser especificar tanto as linhas quanto as colunas a serem selecionados, usando o iloc:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selecao</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">selecao</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        País  PIB (2020)
1  Argentina        0.39
2      Chile        0.28
3    Uruguai        0.06
</pre></div>
</div>
</div>
</div>
<p>Usando loc (por índices etiquetados ou nomes de colunas)</p>
<p>O método loc do Pandas é usado para selecionar linhas e colunas por seus índices etiquetados (ou rótulos) e nomes de colunas, ao contrário do iloc, que usa índices numéricos. Vamos ver como usar o loc com o nosso DataFrame.</p>
<p>Inicialmente, vamos alterar o DataFrame que utilizamos no estudo do método ‘iloc’, definindo como índice etiquetado (rótulo) o nome do país:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;País&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           População     Área  PIB (2020)
País                                     
Brasil     211050000  8515767        2.06
Argentina   45195777  2780400        0.39
Chile       19116201   756102        0.28
Uruguai      3473727   176215        0.06
Paraguai     7044636   406752        0.04
Bolívia     11513100  1098581        0.03
</pre></div>
</div>
</div>
</div>
<p>O método set_index do DataFrame é usado para definir uma coluna como índice (ou rótulo de linha) do DataFrame. O argumento que você fornece a este método especifica a coluna que você deseja usar como índice. Aqui, estamos indicando que queremos definir a coluna ‘País’ como o índice do DataFrame df. Quando inplace é definido como True, a operação modifica o DataFrame original e não retorna um novo DataFrame. Se inplace for False (ou não fornecido), a operação retornará um novo DataFrame com a alteração, e o DataFrame original não será modificado.</p>
<p>Selecionando uma Única Linha</p>
<p>Exemplo: Selecionar a linha com índice ‘Brasil’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linha_brasil</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Brasil&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">linha_brasil</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>População    211050000.00
Área           8515767.00
PIB (2020)           2.06
Name: Brasil, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Selecionando Múltiplas Linhas</p>
<p>Exemplo: Selecionar as linhas com índices ‘Brasil’, ‘Argentina’ e ‘Chile’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linhas_selecionadas</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;Brasil&#39;</span><span class="p">,</span> <span class="s1">&#39;Argentina&#39;</span><span class="p">,</span> <span class="s1">&#39;Chile&#39;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">linhas_selecionadas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           População     Área  PIB (2020)
País                                     
Brasil     211050000  8515767        2.06
Argentina   45195777  2780400        0.39
Chile       19116201   756102        0.28
</pre></div>
</div>
</div>
</div>
<p>Selecionando Linhas e Colunas Simultaneamente</p>
<p>Exemplo: Selecionar as linhas ‘Brasil’ e ‘Argentina’ e as colunas ‘População’ e ‘PIB (2020)’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selecao</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;Brasil&#39;</span><span class="p">,</span> <span class="s1">&#39;Argentina&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">,</span> <span class="s1">&#39;PIB (2020)&#39;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">selecao</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           População  PIB (2020)
País                            
Brasil     211050000        2.06
Argentina   45195777        0.39
</pre></div>
</div>
</div>
</div>
<p>Selecionando Todas as Linhas de Colunas Específicas</p>
<p>Exemplo: Selecionar todas as linhas e apenas a coluna ‘Área’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coluna_area</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Área&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coluna_area</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>País
Brasil       8515767
Argentina    2780400
Chile         756102
Uruguai       176215
Paraguai      406752
Bolívia      1098581
Name: Área, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Filtragem de dados com base em condições</p>
<p>Com o Pandas, é possível filtrar um DataFrame baseado em condições específicas aplicadas às colunas.</p>
<p>A filtragem de dados baseada em condições é uma das operações mais comuns ao trabalhar com DataFrames no Pandas. Isso permite que você selecione subconjuntos de dados que atendam a critérios específicos. Vamos explorar como fazer isso.</p>
<p>Vamos utilizar o DataFrame que tem os rótulos das linhas numerados, mas resetando o seu índice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>País</th>
      <th>População</th>
      <th>Área</th>
      <th>PIB (2020)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Brasil</td>
      <td>211050000</td>
      <td>8515767</td>
      <td>2.06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Argentina</td>
      <td>45195777</td>
      <td>2780400</td>
      <td>0.39</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Chile</td>
      <td>19116201</td>
      <td>756102</td>
      <td>0.28</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Uruguai</td>
      <td>3473727</td>
      <td>176215</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Paraguai</td>
      <td>7044636</td>
      <td>406752</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Bolívia</td>
      <td>11513100</td>
      <td>1098581</td>
      <td>0.03</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Filtragem Simples</p>
<p>Exemplo: selecionar todos os países com uma população maior que 10 milhões.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">paises_10M</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10000000</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">paises_10M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        País  População     Área  PIB (2020)
0     Brasil  211050000  8515767        2.06
1  Argentina   45195777  2780400        0.39
2      Chile   19116201   756102        0.28
5    Bolívia   11513100  1098581        0.03
</pre></div>
</div>
</div>
</div>
<p>Usando Múltiplas Condições:</p>
<p>Se você quiser combinar várias condições, pode usar os operadores “&amp;” (e), “|” (ou) e “ ~ ” (não). Lembre-se de colocar cada condição entre parênteses.</p>
<p>Por exemplo, para selecionar países com uma população maior que 15 milhões e uma área menor que 1 milhão de km2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filtro</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">15000000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Área&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1000000</span><span class="p">)</span>
<span class="n">paises_filtrados</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">filtro</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">paises_filtrados</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    País  População    Área  PIB (2020)
2  Chile   19116201  756102        0.28
</pre></div>
</div>
</div>
</div>
<p>Usando o Método isin:</p>
<p>Se você quiser filtrar com base em uma lista de valores, pode usar o método isin. Por exemplo, para selecionar países que estão na lista <code class="docutils literal notranslate"> <span class="pre">['Brasil',</span> <span class="pre">'Argentina',</span> <span class="pre">'Chile']:</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">paises_lista</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;País&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Brasil&#39;</span><span class="p">,</span> <span class="s1">&#39;Argentina&#39;</span><span class="p">,</span> <span class="s1">&#39;Chile&#39;</span><span class="p">])]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">paises_lista</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        País  População     Área  PIB (2020)
0     Brasil  211050000  8515767        2.06
1  Argentina   45195777  2780400        0.39
2      Chile   19116201   756102        0.28
</pre></div>
</div>
</div>
</div>
<p>Filtragem com query</p>
<p>O método query permite filtrar usando uma string de consulta, o que pode ser mais legível em algumas situações. Por exemplo, para selecionar países com uma área menor que 500.000 km2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">paises_grandes_query</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Área &lt; 500000&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">paises_grandes_query</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       País  População    Área  PIB (2020)
3   Uruguai    3473727  176215        0.06
4  Paraguai    7044636  406752        0.04
</pre></div>
</div>
</div>
</div>
</section>
<section id="manipulacao-de-dados-em-dataframes">
<h3>3.2.2 Manipulação de Dados em DataFrames<a class="headerlink" href="#manipulacao-de-dados-em-dataframes" title="Permalink to this heading">#</a></h3>
<p>A manipulação de dados é uma das principais funcionalidades oferecidas pelo Pandas. Com ela, é possível realizar uma ampla variedade de operações para transformar, limpar e analisar seus conjuntos de dados.</p>
<p>Alterando um valor específico</p>
<p>Para alterar um valor específico, você pode usar loc ou iloc. Exemplo:</p>
<p>Alterar a população do Brasil para 203.062.215:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;País&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Brasil&#39;</span><span class="p">,</span> <span class="s1">&#39;População&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">203062512</span>
</pre></div>
</div>
</div>
</div>
<p>Alterando valores com base em uma condição:</p>
<p>Você pode combinar a filtragem de dados com a atribuição para alterar valores com base em uma condição:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">15000000</span><span class="p">,</span> <span class="s1">&#39;PIB (2020)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
</div>
<p>Neste exemplo, estamos aumentando o PIB (2020) em 100 bilhões (lembrando que o PIB registrado no DataFrame original está em trilhões de dólares) para todos os países com uma população superior a 15 milhões.</p>
<p>Usando o método replace</p>
<p>O método replace é usado para substituir valores específicos. Por exemplo, substituir o nome “Brasil” por “República Federativa do Brasil”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;País&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;País&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Brasil&#39;</span><span class="p">,</span> <span class="s1">&#39;República Federativa do Brasil&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Alterando valores usando uma função com apply</p>
<p>O método apply permite aplicar uma função a cada elemento de uma coluna ou linha. Por exemplo, aumentar a população de todos os países em 5%:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Neste exemplo, estamos multiplicando a população de cada país por 1.05, o que resulta em um aumento de 5% na população original.</p>
<p>Redefinindo valores de uma coluna inteira</p>
<p>Por exemplo, redefinir todos os valores da coluna PIB (2020) para zero:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;PIB (2020)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<p>Estes são apenas alguns exemplos básicos de como alterar valores em um DataFrame do Pandas. A biblioteca oferece uma ampla variedade de métodos e funcionalidades que permitem manipular e transformar dados de maneira eficiente.</p>
<p>Adicionando e removendo colunas</p>
<p>Em muitas situações de análise e manipulação de dados, é comum a necessidade de ajustar a estrutura dos conjuntos de dados para melhor atender aos requisitos do projeto. No contexto dos DataFrames do Pandas, essa flexibilidade é amplamente facilitada através de métodos que permitem adicionar novas colunas, seja com base em cálculos, combinações ou informações externas, bem como remover colunas que podem não ser relevantes para a análise subsequente. Vamos aplicar alguns dos principais métodos a partir de exemplos:</p>
<p>Adicionando uma nova coluna</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Para adicionar uma nova coluna com valores padrão:
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NovaColuna&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Valor Padrão&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Continente&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;América do Sul&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Removendo uma coluna</p>
<p>Para remover uma coluna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Continente&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>O método drop do Pandas é usado para remover linhas ou colunas de um DataFrame. No código fornecido, o método está sendo aplicado para remover uma coluna:</p>
<p>‘Continente’: é o nome da coluna que você deseja remover.</p>
<p>‘axis=1: especifica que a operação deve ser realizada nas colunas. Se você estivesse removendo uma linha, usaria axis=0.</p>
<p>inplace=True: essa opção significa que a alteração será aplicada diretamente no DataFrame df, sem necessidade de reatribuição. Se inplace fosse definido como False (ou omitido, já que o padrão é False), o método retornaria um novo DataFrame com a coluna removida, mas o DataFrame original df permaneceria inalterado.</p>
<p>Adicionando uma coluna com base em outras colunas</p>
<p>Exemplo 1: adicionar uma coluna que seja a razão entre a população e a área.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Densidade_populacional&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Área&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Exemplo 2: Adicionar uma coluna que seja a relação entre o PIB e o número de habitantes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Renda Per Capita&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;PIB (2020)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e12</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Removendo múltiplas colunas</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Para remover várias colunas:
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Densidade_populacional&#39;</span><span class="p">,</span> <span class="s1">&#39;Renda Per Capita&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Adicionando colunas usando assign</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>O método assign permite adicionar uma ou mais colunas ao DataFrame:
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">Densidade_Populacional</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Área&#39;</span><span class="p">],</span>
    <span class="n">PIB_Per_Capita</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;PIB (2020)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e12</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Adicionando colunas em locais específicos</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Para adicionar uma coluna em uma posição específica, é possível usar o método insert:
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Continente&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;América do Sul&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Os argumentos fornecidos ao método insert fazem o seguinte:</p>
<p>loc=1: Especifica a posição (ou índice) onde a nova coluna deve ser inserida. Neste caso, a nova coluna será inserida na posição 1 (lembrando que a indexação começa em 0). Portanto, a nova coluna será a segunda coluna no DataFrame.</p>
<p>column=’Continente’: Define o nome da nova coluna como ‘Continente’.</p>
<p>value=’América do Sul’: Especifica o valor que será preenchido em todas as linhas dessa nova coluna. Aqui, todas as linhas da coluna ‘Continente’ terão o valor ‘América do Sul’.</p>
<p>Neste exemplo, a nova coluna foi inserida na segunda posição (lembre-se que a indexação no Python começa em zero).</p>
<p>Estes são apenas alguns exemplos básicos de como adicionar e remover colunas em um DataFrame do Pandas. A biblioteca oferece uma ampla variedade de métodos e funcionalidades que permitem manipular e transformar dados de maneira eficiente.</p>
</section>
<section id="manipulacao-de-indices">
<h3>3.2.3 Manipulação de índices<a class="headerlink" href="#manipulacao-de-indices" title="Permalink to this heading">#</a></h3>
<p>Índices são essenciais no Pandas, pois permitem acesso rápido a linhas e colunas, facilitam a organização dos dados e são úteis para operações como junções. Já utilizamos métodos para manipulação de índices nos exemplos anteriores. Nesta seção, vamos dar continuidade ao seu estudo. Para tanto, vamos utilizar o mesmo DataFrame dos exemplos anteriores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dicionário de listas</span>
<span class="n">dados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;País&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Brasil&#39;</span><span class="p">,</span> <span class="s1">&#39;Argentina&#39;</span><span class="p">,</span> <span class="s1">&#39;Chile&#39;</span><span class="p">,</span> <span class="s1">&#39;Uruguai&#39;</span><span class="p">,</span> <span class="s1">&#39;Paraguai&#39;</span><span class="p">,</span> <span class="s1">&#39;Bolívia&#39;</span><span class="p">],</span>
    <span class="s1">&#39;População&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">211050000</span><span class="p">,</span> <span class="mi">45195777</span><span class="p">,</span> <span class="mi">19116201</span><span class="p">,</span> <span class="mi">3473727</span><span class="p">,</span> <span class="mi">7044636</span><span class="p">,</span> <span class="mi">11513100</span><span class="p">],</span>
    <span class="s1">&#39;Área&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8515767</span><span class="p">,</span> <span class="mi">2780400</span><span class="p">,</span> <span class="mi">756102</span><span class="p">,</span> <span class="mi">176215</span><span class="p">,</span> <span class="mi">406752</span><span class="p">,</span> <span class="mi">1098581</span><span class="p">],</span>  <span class="c1"># em km^2</span>
    <span class="s1">&#39;PIB (2020)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.055</span><span class="p">,</span> <span class="mf">0.389</span><span class="p">,</span> <span class="mf">0.282</span><span class="p">,</span> <span class="mf">0.056</span><span class="p">,</span> <span class="mf">0.038</span><span class="p">,</span> <span class="mf">0.034</span><span class="p">]</span>  <span class="c1"># PIB em </span>
    <span class="c1"># trilhões de dólares para 2020 (valores aproximados)</span>
<span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Definindo uma coluna como índice</p>
<p>Para definir a coluna “País” como índice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;País&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Renomeando índices</p>
<p>Renomear o índice “Uruguai” para “República Oriental do Uruguai”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Uruguai&#39;</span><span class="p">:</span> <span class="s1">&#39;República Oriental do Uruguai&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>Selecionando linhas por índice</p>
<p>Para selecionar os dados referentes ao Chile:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chile_dados</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Chile&#39;</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
<p>Removendo linhas por índice</p>
<p>Para remover os dados referentes a Argentina:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Argentina&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Verificando a existência de índices</p>
<p>Para verificar se o Brasil está no índice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Brasil&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Para verificar se a Argentina está no índice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Argentina&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>Alterando a ordem dos índices</p>
<p>Para ordenar os países em ordem alfabética decrescente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="operacoes-aritmeticas-com-dataframes">
<h3>3.2.4 Operações aritméticas com DataFrames<a class="headerlink" href="#operacoes-aritmeticas-com-dataframes" title="Permalink to this heading">#</a></h3>
<p>As operações aritméticas com DataFrames são componentes essenciais da análise de dados. Essas operações podem ser realizadas entre colunas de um único DataFrame, entre Series e DataFrames, ou entre dois DataFrames. Abaixo, você encontrará os principais tópicos relacionados a operações aritméticas com DataFrames no Pandas:</p>
<p>Operações Escalares</p>
<p>Exemplo: Aplicar uma operação aritmética entre um DataFrame e um escalar (multiplicar todos os valores do DataFrame por 10):
Inicialmente, vamos criar um DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>Em seguida, aplicamos a multiplicação:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">*</span> <span class="mi">10</span>  <span class="c1"># Multiplica todos os elementos por 10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>50</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>60</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Operações entre Series e DataFrames</p>
<p>Por padrão, ao realizar uma operação entre uma Series e um DataFrame, o Pandas tentará fazer a operação ao longo do índice (para cada linha):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">-</span> <span class="n">s</span>  <span class="c1"># Subtrai a Series de cada linha do DataFrame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>4</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>No código acima, “s” é uma Series do Pandas que contém três elementos com índices ‘A’, ‘B’ e ‘C’. Ao realizar a operação “df – s”, o Pandas tentará subtrair os valores da Series “s” de cada linha do DataFrame df com base nos índices correspondentes. A subtração é feita elemento a elemento, alinhando os índices da Series com as colunas do DataFrame. Para o DataFrame df e a Series “s” fornecidos, a subtração seria:</p>
<p>Observe que a coluna ‘C’ no resultado é preenchida com NaN (Not a Number), porque o DataFrame df não tem uma coluna ‘C’, e o Pandas introduz valores NaN quando não consegue encontrar um valor correspondente para a operação.</p>
<p>Operações entre DataFrames
Quando se realizam operações entre DataFrames, o Pandas alinha os DataFrames pelos índices e pelas colunas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">+</span> <span class="n">df2</span>  <span class="c1"># Realiza a soma elemento a elemento</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Operações com Métodos Específicos</p>
<p>O Pandas também oferece métodos específicos que proporcionam mais controle sobre as operações aritméticas. Por exemplo, o método .add():</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nesse código, fill_value=0 faz com que registros NaN, caso existam, sejam substituídos por 0 antes da operação. Saída:</p>
<p>Operações com Funções Agregadas</p>
<p>Para aplicar funções que agregam dados, como soma, média e contagem, você pode usar métodos como .sum(), .mean() e .count(), respectivamente.</p>
<p>Para o DataFrame df:</p>
<p>Aplicar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A     6
B    15
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Aplicar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    3
B    3
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Existem três registros em cada coluna.</p>
<p>Operações ao longo de um Eixo Específico</p>
<p>Suponha que você queira subtrair a média de cada coluna de todos os valores dessa coluna. Você pode usar o método .sub() e especificar o eixo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.50</td>
      <td>1.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.50</td>
      <td>1.50</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.50</td>
      <td>1.50</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nesse código, df1.mean(axis=1) calcula a média dos valores ao longo do eixo horizontal (ao longo das colunas) para cada linha. O resultado é uma Series onde o seu índice corresponde ao índice das linhas do DataFrame df1 e os valores são as médias calculadas para cada linha.</p>
<p>Continuando com o código acima, df1.sub(df1.mean(axis=1), axis=0) subtrai os valores da Series resultante da etapa anterior de cada coluna do DataFrame df1. O parâmetro axis=0 indica que a operação de subtração deve ser realizada verticalmente (ao longo das linhas). Isso significa que cada valor da Series (a média de cada linha) será subtraído de cada valor na coluna correspondente do DataFrame. Para o DataFrame df1, a subtração seria:</p>
<p>Resultando em:</p>
<p>Operações utilizando o método applymap</p>
<p>O método applymap() é usado em DataFrames do Pandas para aplicar uma função a todos os elementos do DataFrame. Ele é particularmente útil quando você deseja realizar uma operação ou transformação elemento a elemento em todo o DataFrame.</p>
<p>Ao contrário de outros métodos, como apply(), que trabalham ao longo de eixos (linhas ou colunas), o applymap() opera em cada elemento do DataFrame, um por um. Você fornece a função que deseja aplicar como argumento para o applymap(). Esta função é então aplicada a cada elemento do DataFrame.</p>
<p>Vamos ver um exemplo simples para ilustrar o uso do applymap(): Suponha que você tenha um DataFrame com valores numéricos e deseje formatá-los como strings com duas casas decimais:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Criando um DataFrame de exemplo</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.2345</span><span class="p">,</span> <span class="mf">2.3456</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.4567</span><span class="p">,</span> <span class="mf">4.5678</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>Usando applymap() para formatar todos os números para duas casas decimais:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_formatado</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">df_formatado</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.23</td>
      <td>3.46</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.35</td>
      <td>4.57</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Em Series, você pode usar .map() para operações elemento a elemento ou .apply() para operações que produzem um resultado agregado.
Lembre-se de que, quando os índices ou as colunas dos objetos envolvidos na operação não se alinham perfeitamente, o Pandas introduzirá valores NaN nos locais onde os dados estão faltando. Assim, é importante estar atento ao tratamento desses valores após operações aritméticas.</p>
</section>
<section id="tratamento-de-dados-ausentes-ou-faltantes">
<h3>3.2.5 Tratamento de dados ausentes ou faltantes<a class="headerlink" href="#tratamento-de-dados-ausentes-ou-faltantes" title="Permalink to this heading">#</a></h3>
<p>O tratamento de dados ausentes é uma etapa crucial na preparação e limpeza de dados. Dados ausentes podem surgir por diversas razões, como falhas na coleta de dados, erros na entrada ou simplesmente porque a informação não estava disponível. O Pandas fornece várias ferramentas para lidar com esses valores ausentes.</p>
<p>O tratamento adequado de dados ausentes depende do contexto e da natureza dos dados. Em alguns casos, pode ser apropriado preencher valores ausentes, enquanto em outros, pode ser melhor excluir registros ou até mesmo imputar valores com base em outras informações.</p>
<p>Inicialmente, vamos criar um DataFrame com 4 colunas e 8 linhas, utilizando tanto valores numéricos quanto valores NaN (Not a Number) para representar dados faltantes em três das quatro colunas. Os dados faltantes serão criados utilizando np.NaN, que é uma constante especial definida na biblioteca Numpy que representa um valor “Not a Number”. Em termos práticos, é usado para denotar a ausência de um valor ou dados faltantes em arrays e DataFrames.</p>
<p>Para o estudo do tratamento de dados ausentes, vamos utilizar um DataFrame criado a partir de um dicionário:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">31</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   A     B     C     D
0  1   NaN 16.00   NaN
1  2  9.00   NaN 25.00
2  3 10.00 18.00   NaN
3  4   NaN 19.00 27.00
4  5 12.00 20.00   NaN
5  6 13.00   NaN 29.00
6  7 14.00 22.00   NaN
7  8   NaN 23.00 31.00
</pre></div>
</div>
</div>
</div>
<p>Identificação de dados ausentes</p>
<p>O Pandas utiliza o valor NaN (Not a Number) para representar dados ausentes. Você pode identificar esses valores usando o método isna() ou isnull(), ambos retornam o mesmo resultado: um DataFrame de mesma dimensão com valores booleanos (True ou False) indicando a presença de valores faltantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       A      B      C      D
0  False   True  False   True
1  False  False   True  False
2  False  False  False   True
3  False   True  False  False
4  False  False  False   True
5  False  False   True  False
6  False  False  False   True
7  False   True  False  False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       A      B      C      D
0  False   True  False   True
1  False  False   True  False
2  False  False  False   True
3  False   True  False  False
4  False  False  False   True
5  False  False   True  False
6  False  False  False   True
7  False   True  False  False
</pre></div>
</div>
</div>
</div>
<p>Para contar o número de valores faltantes por coluna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    0
B    3
C    2
D    4
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Para contar o total de valores faltantes no DataFrame inteiro:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
<p>Estratégias para tratamento de dados faltantes: exclusão e imputação</p>
<p>O tratamento de dados faltantes é uma etapa importante na análise e preparação de dados, especialmente porque a presença de valores faltantes pode distorcer análises. Existem várias estratégias para lidar com dados faltantes, e a escolha da estratégia adequada geralmente depende do contexto e da natureza dos dados. Vamos explorar duas categorias principais: exclusão e imputação.</p>
<p>Exclusão de dados ausentes</p>
<p>A exclusão de dados ausentes em um DataFrame é uma abordagem que pode ser aplicada tanto às linhas quanto às colunas. Dependendo da natureza e da quantidade de dados ausentes, você pode optar por remover registros inteiros (linhas) ou características específicas (colunas) para manter a integridade e a qualidade dos dados analisados.</p>
<p>A exclusão de linhas com valores faltantes é atrativa devido à sua simplicidade e rapidez de implementação. Além disso, ao evitar suposições ou imputações, a exclusão mantém a pureza dos dados. No entanto, essa abordagem não está isenta de desvantagens. A remoção de registros pode levar à perda significativa de informações, particularmente em conjuntos de dados onde a ausência de valores é comum. Adicionalmente, se os valores ausentes em um conjunto de dados não forem aleatoriamente distribuídos, a exclusão pode introduzir um viés, potencialmente levando a interpretações distorcidas ou análises imprecisas.</p>
<p>O método .dropna() é uma função da biblioteca Pandas, utilizada para tratar dados faltantes em DataFrames. Ao aplicá-lo, todas as linhas que contêm pelo menos um valor faltante (NaN ou None) são excluídas do DataFrame. Por padrão, a operação é feita nas linhas, ou seja, se qualquer valor em uma linha for NaN ou None, toda a linha será removida. É importante notar que, a menos que o argumento inplace=True seja especificado, o método dropna() retornará um novo DataFrame com os valores faltantes removidos, sem alterar o DataFrame original.</p>
<p>Vamos aplicar o método dropna() em nosso DataFrame df:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>  <span class="c1"># Remove linhas com qualquer valor faltante</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>No caso de nosso DataFrame, como havia dados faltantes em todas as linhas, em pelo menos uma coluna, todos os dados foram removidos, resultando em um DataFrame vazio.</p>
<p>A exclusão de colunas é uma estratégia considerada quando se depara com atributos que possuem uma quantidade significativa de valores faltantes. Esta abordagem pode ser especialmente útil quando uma coluna tem uma proporção tão alta de dados ausentes que a tentativa de imputação ou interpretação se torna inviável ou pouco confiável. No entanto, optar por descartar uma coluna inteira traz o risco de perder uma característica potencialmente relevante para a análise. É crucial ponderar a relevância da informação contida na coluna e o impacto de sua perda no contexto da análise ou modelo em questão.</p>
<p>Se você desejar remover colunas que contêm valores faltantes utilizando o método dropna(), pode usar o argumento axis=1. Ao fazer isso, todas as colunas que contêm pelo menos um valor faltante serão excluídas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Remove colunas com qualquer valor faltante</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>No caso do nosso DataFrame df, somente a coluna “A “não possuía dados faltantes. Logo, o DataFrame (agora, uma Series) resultante tem somente os dados dessa coluna.</p>
<p>Imputação</p>
<p>A imputação é uma técnica fundamental no pré-processamento de dados para tratar valores faltantes. Dentre as abordagens mais populares para realizá-la, podemos citar: a) a imputação com valor constante; b) a imputação com média, mediana ou moda; c) a interpolação e; d) a imputação utilizando métodos avançados. Vamos detalhar essas abordagens a seguir.</p>
<p>Imputação com Valor Constante</p>
<p>A imputação com valor constante é uma abordagem na qual os valores faltantes são substituídos por um valor fixo, determinado previamente. Esta técnica é simples e rápida, sendo atraente em cenários onde se deseja uma solução imediata. No entanto, há ressalvas a serem consideradas. Substituir dados ausentes por um valor constante pode não refletir a realidade do conjunto de dados, especialmente se os valores ausentes não forem aleatórios. Além disso, essa estratégia pode introduzir distorções, alterando a distribuição original dos dados e potencialmente levando a interpretações errôneas.</p>
<p>O método fillna() do Pandas é utilizado para preencher valores faltantes (representados como NaN) em um DataFrame ou Series. Vamos aplicá-lo em nosso DataFrame df:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.00</td>
      <td>16.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>9.00</td>
      <td>0.00</td>
      <td>25.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>10.00</td>
      <td>18.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.00</td>
      <td>19.00</td>
      <td>27.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>12.00</td>
      <td>20.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>13.00</td>
      <td>0.00</td>
      <td>29.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>14.00</td>
      <td>22.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.00</td>
      <td>23.00</td>
      <td>31.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ao usar df.fillna(0), você está instruindo o Pandas a substituir todos os valores faltantes no DataFrame df pelo número zero. Em outras palavras, qualquer entrada que seja NaN no DataFrame original será substituída por zero na saída resultante.</p>
<p>Imputação com média, mediana ou moda</p>
<p>A utilização de métodos que levam em consideração a distribuição dos dados para tratar valores faltantes normalmente é uma opção mais refinada. Esta abordagem, que pode envolver o uso da média, mediana ou moda, tende a ser mais realista do que simplesmente substituir os valores ausentes por uma constante arbitrária, pois baseia-se na tendência central dos dados disponíveis. No entanto, nem sempre é a solução ideal.</p>
<p>Em conjuntos de dados com distribuições altamente enviesadas ou com uma quantidade significativa de outliers (valores ou pontos em um conjunto de dados que se desviam significativamente dos outros pontos e, por isso, são considerados anômalos), essa técnica pode não ser a mais apropriada, já que a substituição de valores faltantes baseada nessas métricas pode não representar adequadamente a característica intrínseca do conjunto de dados.</p>
<p>Vamos aplicar uma imputação com a média em nosso DataFrame df:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>11.60</td>
      <td>16.00</td>
      <td>28.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>9.00</td>
      <td>19.67</td>
      <td>25.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>10.00</td>
      <td>18.00</td>
      <td>28.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>11.60</td>
      <td>19.00</td>
      <td>27.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>12.00</td>
      <td>20.00</td>
      <td>28.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>13.00</td>
      <td>19.67</td>
      <td>29.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>14.00</td>
      <td>22.00</td>
      <td>28.00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>11.60</td>
      <td>23.00</td>
      <td>31.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ao usar df.fillna(df.mean()), você está instruindo o Pandas a substituir todos os valores faltantes no DataFrame df pela média da respectiva coluna em que o valor faltante está localizado. Para ser mais específico, se uma coluna do DataFrame tiver algum valor faltante, esse valor será substituído pela média de todos os outros valores (não faltantes) da mesma coluna.</p>
<p>Interpolação</p>
<p>A interpolação é especialmente útil em séries temporais ou dados sequenciais. A interpolação estima valores faltantes com base nos valores existentes antes e depois do ponto faltante. Por exemplo, em uma série temporal, se tivermos valores para os dias 1, 2 e 4, mas o dia 3 estiver faltando, a interpolação pode ser usada para estimar o valor para o dia 3 com base nos valores dos dias 2 e 4. Existem vários métodos de interpolação, desde técnicas lineares simples até métodos mais complexos, como interpolação polinomial ou spline. A escolha do método de interpolação deve ser feita considerando a natureza dos dados e o padrão subjacente que se acredita existir na sequência. Vamos aplicar a interpolação ao nosso DataFrame df:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>NaN</td>
      <td>16.00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>9.00</td>
      <td>17.00</td>
      <td>25.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>10.00</td>
      <td>18.00</td>
      <td>26.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>11.00</td>
      <td>19.00</td>
      <td>27.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>12.00</td>
      <td>20.00</td>
      <td>28.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>13.00</td>
      <td>21.00</td>
      <td>29.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>14.00</td>
      <td>22.00</td>
      <td>30.00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>14.00</td>
      <td>23.00</td>
      <td>31.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A função interpolate() do Pandas utiliza, por padrão, um método de interpolação linear para preencher os valores NaN. No entanto, ela não consegue interpolar os valores NaN que estão nas extremidades do DataFrame (primeira e última linhas), pois não há dados adjacentes de um dos lados para calcular a interpolação.</p>
<p>Para lidar com valores NaN nas extremidades, você pode considerar outras abordagens, como: preencher com um valor constante, preencher com a média da coluna ou aplicar métodos como bfill ou ffill.</p>
<p>Imputação com Métodos Avançados</p>
<p>Existem métodos de imputação de dados mais avançados, como a imputação KNN (K-Nearest Neighbors), imputação por regressão e algoritmos como o MICE (Multiple Imputation by Chained Equations). Embora esses métodos possam oferecer uma precisão superior em comparação com abordagens mais simples, eles são computacionalmente mais intensivos e demandam uma compreensão mais profunda por parte do usuário.</p>
<p>As vantagens incluem a potencial precisão elevada, enquanto as desvantagens giram em torno da sua complexidade e da necessidade de um maior poder computacional. Além disso, a implementação correta requer conhecimento adicional.</p>
</section>
<section id="agrupamento-e-agregacao-de-dados">
<h3>3.2.6 Agrupamento e Agregação de Dados<a class="headerlink" href="#agrupamento-e-agregacao-de-dados" title="Permalink to this heading">#</a></h3>
<p>O agrupamento e a agregação de dados são técnicas importantes para analisar e resumir grandes conjuntos de dados. Elas permitem que você segmente seus dados em grupos e aplique funções de resumo a cada grupo, facilitando a identificação de padrões e tendências. Neste capítulo, exploraremos como realizar essas operações usando a biblioteca Pandas em Python. Para tanto vamos criar um DataFrame com dados sobre imagens de satélite:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">paises_dados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;País&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Argentina&#39;</span><span class="p">,</span> <span class="s1">&#39;Bolívia&#39;</span><span class="p">,</span> <span class="s1">&#39;Brasil&#39;</span><span class="p">,</span> <span class="s1">&#39;Chile&#39;</span><span class="p">,</span> <span class="s1">&#39;Colômbia&#39;</span><span class="p">,</span> <span class="s1">&#39;Equador&#39;</span><span class="p">,</span> <span class="s1">&#39;Guiana&#39;</span><span class="p">,</span> <span class="s1">&#39;Paraguai&#39;</span><span class="p">,</span> <span class="s1">&#39;Peru&#39;</span><span class="p">,</span> <span class="s1">&#39;Suriname&#39;</span><span class="p">,</span> <span class="s1">&#39;Uruguai&#39;</span><span class="p">,</span> <span class="s1">&#39;Venezuela&#39;</span><span class="p">],</span>
    <span class="s1">&#39;População&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">45195777</span><span class="p">,</span> <span class="mi">11513100</span><span class="p">,</span> <span class="mi">211050000</span><span class="p">,</span> <span class="mi">19116201</span><span class="p">,</span> <span class="mi">50882891</span><span class="p">,</span> <span class="mi">17643054</span><span class="p">,</span> <span class="mi">786552</span><span class="p">,</span> <span class="mi">7044636</span><span class="p">,</span> <span class="mi">32971854</span><span class="p">,</span> <span class="mi">586632</span><span class="p">,</span> <span class="mi">3473727</span><span class="p">,</span> <span class="mi">28435940</span><span class="p">],</span>
    <span class="s1">&#39;Área&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2780400</span><span class="p">,</span> <span class="mi">1098581</span><span class="p">,</span> <span class="mi">8515767</span><span class="p">,</span> <span class="mi">756102</span><span class="p">,</span> <span class="mi">1141748</span><span class="p">,</span> <span class="mi">283561</span><span class="p">,</span> <span class="mi">214969</span><span class="p">,</span> <span class="mi">406752</span><span class="p">,</span> <span class="mi">1285216</span><span class="p">,</span> <span class="mi">163821</span><span class="p">,</span> <span class="mi">176215</span><span class="p">,</span> <span class="mi">912050</span><span class="p">],</span>
    <span class="s1">&#39;Independência&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;1816-07-09&#39;</span><span class="p">,</span> <span class="s1">&#39;1825-08-06&#39;</span><span class="p">,</span> <span class="s1">&#39;1822-09-07&#39;</span><span class="p">,</span> <span class="s1">&#39;1818-02-12&#39;</span><span class="p">,</span> <span class="s1">&#39;1810-07-20&#39;</span><span class="p">,</span> <span class="s1">&#39;1822-05-24&#39;</span><span class="p">,</span> <span class="s1">&#39;1966-05-26&#39;</span><span class="p">,</span> <span class="s1">&#39;1811-05-14&#39;</span><span class="p">,</span> <span class="s1">&#39;1821-07-28&#39;</span><span class="p">,</span> <span class="s1">&#39;1975-11-25&#39;</span><span class="p">,</span> <span class="s1">&#39;1825-08-25&#39;</span><span class="p">,</span> <span class="s1">&#39;1811-07-05&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">paises_dados</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>País</th>
      <th>População</th>
      <th>Área</th>
      <th>Independência</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Argentina</td>
      <td>45195777</td>
      <td>2780400</td>
      <td>1816-07-09</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bolívia</td>
      <td>11513100</td>
      <td>1098581</td>
      <td>1825-08-06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Brasil</td>
      <td>211050000</td>
      <td>8515767</td>
      <td>1822-09-07</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Chile</td>
      <td>19116201</td>
      <td>756102</td>
      <td>1818-02-12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Colômbia</td>
      <td>50882891</td>
      <td>1141748</td>
      <td>1810-07-20</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Equador</td>
      <td>17643054</td>
      <td>283561</td>
      <td>1822-05-24</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Guiana</td>
      <td>786552</td>
      <td>214969</td>
      <td>1966-05-26</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Paraguai</td>
      <td>7044636</td>
      <td>406752</td>
      <td>1811-05-14</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Peru</td>
      <td>32971854</td>
      <td>1285216</td>
      <td>1821-07-28</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Suriname</td>
      <td>586632</td>
      <td>163821</td>
      <td>1975-11-25</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Uruguai</td>
      <td>3473727</td>
      <td>176215</td>
      <td>1825-08-25</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Venezuela</td>
      <td>28435940</td>
      <td>912050</td>
      <td>1811-07-05</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Funções de agregação</p>
<p>As funções de agregação proporcionam um resumo estatístico ou uma redução dos dados. Quando você tem um grande conjunto de dados e quer obter informações resumidas ou insights gerais, as funções de agregação são muito úteis. No Python, especialmente com o Pandas, temos várias funções de agregação à disposição.</p>
<p>Aqui estão algumas das funções de agregação mais comuns:</p>
<p>min() e max(): Retorna os valores mínimo e máximo registrado em cada coluna no DataFrame, respectivamente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Área&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>163821
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Área&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8515767
</pre></div>
</div>
</div>
</div>
<p>sum(): Calcula a soma total de uma coluna.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>428700364
</pre></div>
</div>
</div>
</div>
<p>mean(): Calcula a média aritmética.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>35725030.333333336
</pre></div>
</div>
</div>
</div>
<p>median(): Retorna a mediana de uma coluna ordenada.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18379627.5
</pre></div>
</div>
</div>
</div>
<p>std(): Calcula o desvio padrão, que é uma medida de dispersão dos dados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>57703124.3291084
</pre></div>
</div>
</div>
</div>
<p>var(): Calcula a variância dos dados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3329650557340542.0
</pre></div>
</div>
</div>
</div>
<p>quantile(): Retorna valores em percentis específicos de uma coluna.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;População&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6151908.75
</pre></div>
</div>
</div>
</div>
<p>Count(): Conta o número de itens não nulos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;País&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
<p>nunique(): Conta o número de valores únicos em uma coluna.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;País&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
<p>unique(): Retorna um array dos valores únicos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;País&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Argentina&#39;, &#39;Bolívia&#39;, &#39;Brasil&#39;, &#39;Chile&#39;, &#39;Colômbia&#39;, &#39;Equador&#39;,
       &#39;Guiana&#39;, &#39;Paraguai&#39;, &#39;Peru&#39;, &#39;Suriname&#39;, &#39;Uruguai&#39;, &#39;Venezuela&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<p>agg() ou aggregate(): Permite aplicar várias funções de agregação ao mesmo tempo ou especificar funções de agregação para colunas específicas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;População&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;Área&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>População   428700364.00
Área          1477931.83
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Método Groupby</p>
<p>O método groupby é uma ferramenta do Pandas que permite agrupar dados com base em algumas colunas e, em seguida, aplicar uma função (como soma, média, contagem, etc.) a cada grupo. Esse método é especialmente útil para segmentar um DataFrame em subconjuntos de dados para análise. Ele opera em três etapas fundamentais: Dividir, Aplicar e Combinar.</p>
<p>Dividir: Nesta etapa, o DataFrame é dividido em grupos com base em uma ou mais colunas especificadas. Cada grupo é um subconjunto do DataFrame que tem o mesmo valor na coluna (ou colunas) especificada(s);</p>
<p>Aplicar: Uma vez que os dados são agrupados, uma função é aplicada a cada grupo individualmente. Esta função pode ser uma operação de agregação (como calcular a média, a soma, a contagem, etc.), uma transformação (como normalizações ou cálculos mais complexos) ou qualquer outra operação que você queira realizar em grupos específicos;</p>
<p>Combinar: Após aplicar a função a cada grupo, o Pandas combina os resultados em uma nova estrutura, geralmente um DataFrame. O resultado é um DataFrame reformulado, onde os índices são os valores únicos das colunas usadas para agrupar e as colunas contêm os resultados das funções aplicadas.</p>
<p>Exemplos:</p>
<p>Inicialmente, vamos criar um DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Imagem&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Landsat 8&#39;</span><span class="p">,</span> <span class="s1">&#39;Sentinel-2&#39;</span><span class="p">,</span> <span class="s1">&#39;Landsat 8&#39;</span><span class="p">,</span> <span class="s1">&#39;WorldView-3&#39;</span><span class="p">,</span> <span class="s1">&#39;Sentinel-2&#39;</span><span class="p">,</span>
     <span class="s1">&#39;WorldView-3&#39;</span><span class="p">,</span> <span class="s1">&#39;Landsat 8&#39;</span><span class="p">,</span> <span class="s1">&#39;Sentinel-2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Região&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Amazônia&#39;</span><span class="p">,</span> <span class="s1">&#39;Cerrado&#39;</span><span class="p">,</span> <span class="s1">&#39;Pantanal&#39;</span><span class="p">,</span> <span class="s1">&#39;Pantanal&#39;</span><span class="p">,</span> <span class="s1">&#39;Amazônia&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Caatinga&#39;</span><span class="p">,</span> <span class="s1">&#39;Caatinga&#39;</span><span class="p">,</span> <span class="s1">&#39;Cerrado&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Área Coberta (km²)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1250</span><span class="p">,</span> <span class="mi">1750</span><span class="p">],</span>
    <span class="s1">&#39;Custo (R$)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">15000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="mi">25000</span><span class="p">,</span> <span class="mi">70000</span><span class="p">,</span> <span class="mi">7500</span><span class="p">,</span> <span class="mi">15000</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dados</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Imagem</th>
      <th>Região</th>
      <th>Área Coberta (km²)</th>
      <th>Custo (R$)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Landsat 8</td>
      <td>Amazônia</td>
      <td>1000</td>
      <td>5000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sentinel-2</td>
      <td>Cerrado</td>
      <td>1500</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Landsat 8</td>
      <td>Pantanal</td>
      <td>2000</td>
      <td>15000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>WorldView-3</td>
      <td>Pantanal</td>
      <td>500</td>
      <td>50000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sentinel-2</td>
      <td>Amazônia</td>
      <td>3000</td>
      <td>25000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>WorldView-3</td>
      <td>Caatinga</td>
      <td>750</td>
      <td>70000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Landsat 8</td>
      <td>Caatinga</td>
      <td>1250</td>
      <td>7500</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Sentinel-2</td>
      <td>Cerrado</td>
      <td>1750</td>
      <td>15000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>a) Agrupar os dados por ‘Imagem’ e obter a soma da ‘Área Coberta (km²)’ para cada tipo de imagem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Imagem&#39;</span><span class="p">)[</span><span class="s1">&#39;Área Coberta (km²)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Imagem
Landsat 8      4250
Sentinel-2     6250
WorldView-3    1250
Name: Área Coberta (km²), dtype: int64
</pre></div>
</div>
</div>
</div>
<p>b) Agrupar os dados por ‘Região’ e calcular a média do ‘Custo (R$)’:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Região&#39;</span><span class="p">)[</span><span class="s1">&#39;Custo (R$)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Região
Amazônia   15000.00
Caatinga   38750.00
Cerrado    12500.00
Pantanal   32500.00
Name: Custo (R$), dtype: float64
</pre></div>
</div>
</div>
</div>
<p>c) Agrupar os dados por ‘Imagem’ e ‘Região’ e obter a contagem de registros para cada combinação:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Imagem&#39;</span><span class="p">,</span> <span class="s1">&#39;Região&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Imagem       Região  
Landsat 8    Amazônia    1
             Caatinga    1
             Pantanal    1
Sentinel-2   Amazônia    1
             Cerrado     2
WorldView-3  Caatinga    1
             Pantanal    1
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>d) Agrupar os dados por ‘Imagem’ e obter várias agregações para a coluna ‘Custo (R$)’ (média, soma e desvio padrão):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Imagem&#39;</span><span class="p">)[</span><span class="s1">&#39;Custo (R$)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sum</th>
      <th>std</th>
    </tr>
    <tr>
      <th>Imagem</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Landsat 8</th>
      <td>9166.67</td>
      <td>27500</td>
      <td>5204.16</td>
    </tr>
    <tr>
      <th>Sentinel-2</th>
      <td>16666.67</td>
      <td>50000</td>
      <td>7637.63</td>
    </tr>
    <tr>
      <th>WorldView-3</th>
      <td>60000.00</td>
      <td>120000</td>
      <td>14142.14</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Combinação de Dados</p>
<p>A combinação de dados é uma operação de grande relevância em geoprocessamento, permitindo que você junte informações de diferentes fontes ou DataFrames. Existem várias ferramentas para combinar DataFrames no Pandas, incluindo concatenação, junção e mesclagem.</p>
<p>Concatenação de DataFrames:</p>
<p>A concatenação é o processo de anexar um DataFrame a outro, seja verticalmente (adicionando linhas) ou horizontalmente (adicionando colunas).</p>
<p>Exemplo: Suponha que temos dois subconjuntos do nosso DataFrame df:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Imagem</th>
      <th>Região</th>
      <th>Área Coberta (km²)</th>
      <th>Custo (R$)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Landsat 8</td>
      <td>Amazônia</td>
      <td>1000</td>
      <td>5000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sentinel-2</td>
      <td>Cerrado</td>
      <td>1500</td>
      <td>10000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Imagem</th>
      <th>Região</th>
      <th>Área Coberta (km²)</th>
      <th>Custo (R$)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Landsat 8</td>
      <td>Pantanal</td>
      <td>2000</td>
      <td>15000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>WorldView-3</td>
      <td>Pantanal</td>
      <td>500</td>
      <td>50000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Relembrando: Esse código utiliza o método iloc do Pandas, que é usado para selecionar linhas e colunas por suas posições numéricas (índices).</p>
<p>df1 = <code class="docutils literal notranslate"><span class="pre">df.iloc[:2]</span></code> seleciona as duas primeiras linhas do DataFrame df, atribuindo-as a um novo DataFrame chamado df1. O “:2” especifica que queremos todas as linhas do início até a posição 2 (exclusiva), ou seja, as linhas nas posições 0 e 1.</p>
<p>df2 = <code class="docutils literal notranslate"><span class="pre">df.iloc[2:4]</span></code> seleciona as linhas nas posições 2 e 3 do DataFrame df, atribuindo-as a um novo DataFrame chamado df2. O “2:4” especifica que queremos as linhas da posição 2 até a posição 4 (o registro que está na posição 4 não é selecionado).</p>
<p>Para concatená-los verticalmente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_concatenado</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">])</span>
<span class="n">df_concatenado</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Imagem</th>
      <th>Região</th>
      <th>Área Coberta (km²)</th>
      <th>Custo (R$)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Landsat 8</td>
      <td>Amazônia</td>
      <td>1000</td>
      <td>5000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sentinel-2</td>
      <td>Cerrado</td>
      <td>1500</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Landsat 8</td>
      <td>Pantanal</td>
      <td>2000</td>
      <td>15000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>WorldView-3</td>
      <td>Pantanal</td>
      <td>500</td>
      <td>50000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para aplicar a concatenação horizontal, considere o conjunto de dados adicional:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dado_adicional</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Qualidade&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alta&#39;</span><span class="p">,</span> <span class="s1">&#39;Média&#39;</span><span class="p">,</span> <span class="s1">&#39;Baixa&#39;</span><span class="p">,</span> <span class="s1">&#39;Alta&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Alta&#39;</span><span class="p">,</span> <span class="s1">&#39;Média&#39;</span><span class="p">,</span> <span class="s1">&#39;Baixa&#39;</span><span class="p">,</span> <span class="s1">&#39;Alta&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df_adicional</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dado_adicional</span><span class="p">)</span>
<span class="n">df_adicional</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Qualidade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alta</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Média</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Baixa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Alta</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Alta</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Média</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Baixa</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Alta</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para conectá-lo horizontalmente com o DataFrame ‘df’:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_horizontal</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df_adicional</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_horizontal</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Imagem</th>
      <th>Região</th>
      <th>Área Coberta (km²)</th>
      <th>Custo (R$)</th>
      <th>Qualidade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Landsat 8</td>
      <td>Amazônia</td>
      <td>1000</td>
      <td>5000</td>
      <td>Alta</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sentinel-2</td>
      <td>Cerrado</td>
      <td>1500</td>
      <td>10000</td>
      <td>Média</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Landsat 8</td>
      <td>Pantanal</td>
      <td>2000</td>
      <td>15000</td>
      <td>Baixa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>WorldView-3</td>
      <td>Pantanal</td>
      <td>500</td>
      <td>50000</td>
      <td>Alta</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sentinel-2</td>
      <td>Amazônia</td>
      <td>3000</td>
      <td>25000</td>
      <td>Alta</td>
    </tr>
    <tr>
      <th>5</th>
      <td>WorldView-3</td>
      <td>Caatinga</td>
      <td>750</td>
      <td>70000</td>
      <td>Média</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Landsat 8</td>
      <td>Caatinga</td>
      <td>1250</td>
      <td>7500</td>
      <td>Baixa</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Sentinel-2</td>
      <td>Cerrado</td>
      <td>1750</td>
      <td>15000</td>
      <td>Alta</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Neste exemplo, o argumento axis=1 indica que a concatenação deve ocorrer horizontalmente. O resultado é um DataFrame que combina as colunas de df  e df_adicional:</p>
<p>Ao usar o método concat, é importante garantir que os índices dos DataFrames que estão sendo concatenados se alinhem corretamente, especialmente ao realizar a concatenação horizontal. Caso contrário, você pode acabar com valores ausentes nas posições onde os índices não se alinham.</p>
<p>b) junção e mesclagem
A junção e a mesclagem permitem combinar DataFrames com base em colunas comuns ou índices comuns. Vamos explorar como usar essas técnicas com os DataFrames df e df_satelites.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dados_satelites</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Satélite&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Landsat 8&#39;</span><span class="p">,</span> <span class="s1">&#39;Sentinel-2&#39;</span><span class="p">,</span> <span class="s1">&#39;WorldView-3&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Resolução Espacial (m)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">],</span>  
    <span class="c1"># Resolução do sensor óptico principal</span>
    <span class="s1">&#39;Operador&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;NASA/USGS&#39;</span><span class="p">,</span> <span class="s1">&#39;ESA&#39;</span><span class="p">,</span> <span class="s1">&#39;DigitalGlobe&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df_satelites</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dados_satelites</span><span class="p">)</span>
<span class="n">df_satelites</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Satélite</th>
      <th>Resolução Espacial (m)</th>
      <th>Operador</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Landsat 8</td>
      <td>30.00</td>
      <td>NASA/USGS</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sentinel-2</td>
      <td>10.00</td>
      <td>ESA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WorldView-3</td>
      <td>0.31</td>
      <td>DigitalGlobe</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Merge</p>
<p>O método merge() é usado para combinar DataFrames com base em colunas comuns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mesclado</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_satelites</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;Imagem&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;Satélite&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">df_mesclado</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Imagem</th>
      <th>Região</th>
      <th>Área Coberta (km²)</th>
      <th>Custo (R$)</th>
      <th>Satélite</th>
      <th>Resolução Espacial (m)</th>
      <th>Operador</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Landsat 8</td>
      <td>Amazônia</td>
      <td>1000</td>
      <td>5000</td>
      <td>Landsat 8</td>
      <td>30.00</td>
      <td>NASA/USGS</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sentinel-2</td>
      <td>Cerrado</td>
      <td>1500</td>
      <td>10000</td>
      <td>Sentinel-2</td>
      <td>10.00</td>
      <td>ESA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Landsat 8</td>
      <td>Pantanal</td>
      <td>2000</td>
      <td>15000</td>
      <td>Landsat 8</td>
      <td>30.00</td>
      <td>NASA/USGS</td>
    </tr>
    <tr>
      <th>3</th>
      <td>WorldView-3</td>
      <td>Pantanal</td>
      <td>500</td>
      <td>50000</td>
      <td>WorldView-3</td>
      <td>0.31</td>
      <td>DigitalGlobe</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sentinel-2</td>
      <td>Amazônia</td>
      <td>3000</td>
      <td>25000</td>
      <td>Sentinel-2</td>
      <td>10.00</td>
      <td>ESA</td>
    </tr>
    <tr>
      <th>5</th>
      <td>WorldView-3</td>
      <td>Caatinga</td>
      <td>750</td>
      <td>70000</td>
      <td>WorldView-3</td>
      <td>0.31</td>
      <td>DigitalGlobe</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Landsat 8</td>
      <td>Caatinga</td>
      <td>1250</td>
      <td>7500</td>
      <td>Landsat 8</td>
      <td>30.00</td>
      <td>NASA/USGS</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Sentinel-2</td>
      <td>Cerrado</td>
      <td>1750</td>
      <td>15000</td>
      <td>Sentinel-2</td>
      <td>10.00</td>
      <td>ESA</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Neste exemplo, estamos usando left_on para especificar a coluna do DataFrame df e right_on para especificar a coluna do DataFrame df_satelites. O argumento how=’left’ garante que todas as entradas do df sejam mantidas, mesmo que não tenham uma correspondência no df_satelites.</p>
<p>Junção (join)</p>
<p>O método join é semelhante ao merge, mas é usado para combinar DataFrames com base em índices ao invés de colunas. Para demonstrá-lo, vamos primeiro definir o índice de df_satelites para a coluna ‘Satélite’:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_satelites</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Satélite&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_satelites</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Resolução Espacial (m)</th>
      <th>Operador</th>
    </tr>
    <tr>
      <th>Satélite</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Landsat 8</th>
      <td>30.00</td>
      <td>NASA/USGS</td>
    </tr>
    <tr>
      <th>Sentinel-2</th>
      <td>10.00</td>
      <td>ESA</td>
    </tr>
    <tr>
      <th>WorldView-3</th>
      <td>0.31</td>
      <td>DigitalGlobe</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Agora, podemos usar join para combinar os DataFrames:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_juncao</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_satelites</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Imagem&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">df_juncao</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Imagem</th>
      <th>Região</th>
      <th>Área Coberta (km²)</th>
      <th>Custo (R$)</th>
      <th>Resolução Espacial (m)</th>
      <th>Operador</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Landsat 8</td>
      <td>Amazônia</td>
      <td>1000</td>
      <td>5000</td>
      <td>30.00</td>
      <td>NASA/USGS</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sentinel-2</td>
      <td>Cerrado</td>
      <td>1500</td>
      <td>10000</td>
      <td>10.00</td>
      <td>ESA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Landsat 8</td>
      <td>Pantanal</td>
      <td>2000</td>
      <td>15000</td>
      <td>30.00</td>
      <td>NASA/USGS</td>
    </tr>
    <tr>
      <th>3</th>
      <td>WorldView-3</td>
      <td>Pantanal</td>
      <td>500</td>
      <td>50000</td>
      <td>0.31</td>
      <td>DigitalGlobe</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sentinel-2</td>
      <td>Amazônia</td>
      <td>3000</td>
      <td>25000</td>
      <td>10.00</td>
      <td>ESA</td>
    </tr>
    <tr>
      <th>5</th>
      <td>WorldView-3</td>
      <td>Caatinga</td>
      <td>750</td>
      <td>70000</td>
      <td>0.31</td>
      <td>DigitalGlobe</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Landsat 8</td>
      <td>Caatinga</td>
      <td>1250</td>
      <td>7500</td>
      <td>30.00</td>
      <td>NASA/USGS</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Sentinel-2</td>
      <td>Cerrado</td>
      <td>1750</td>
      <td>15000</td>
      <td>10.00</td>
      <td>ESA</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Neste exemplo, estamos usando on para especificar a coluna do DataFrame df que deve ser usada para a junção. Novamente, how=’left’ garante que todas as entradas do df  sejam mantidas.</p>
</section>
</section>
<section id="importacao-e-exportacao-de-dados">
<h2>3.3 Importação e exportação de dados<a class="headerlink" href="#importacao-e-exportacao-de-dados" title="Permalink to this heading">#</a></h2>
<p>A capacidade de importar e exportar dados é fundamental ao trabalhar com análise de dados no contexto do Geoprocessamento. O Pandas oferece uma ampla variedade de funções para ler e escrever dados em diversos formatos. Vamos explorar a importação e exportação de dados usando Pandas, com foco em arquivos CSV e Excel.</p>
<section id="arquivos-csv-comma-separated-values">
<h3>3.3.1 Arquivos CSV (Comma-Separated Values)<a class="headerlink" href="#arquivos-csv-comma-separated-values" title="Permalink to this heading">#</a></h3>
<p>A leitura de arquivos CSV (Comma-Separated Values) é uma das tarefas mais comuns ao se trabalhar com análise de dados em Python. No Pandas utilizamos a função read_CSV. Vamos explorar os principais aspectos e opções dessa função:
Sintaxe básica:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;caminho_do_arquivo.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Caso o delimitador do arquivo seja ponto e vírgula, é possível utilizar o parâmetro “sep”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;caminho_do_arquivo.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Quadro 6: Parâmetros do método read_csv.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Parâmetro</p></th>
<th class="head"><p>Descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>filepath_or_buffer</p></td>
<td><p>String contendo o caminho para o arquivo ou um objeto do tipo arquivo.</p></td>
</tr>
<tr class="row-odd"><td><p>sep</p></td>
<td><p>Delimitador a ser usado. Padrão é ‘,’.</p></td>
</tr>
<tr class="row-even"><td><p>delimiter</p></td>
<td><p>Alternativa ao argumento sep.</p></td>
</tr>
<tr class="row-odd"><td><p>header</p></td>
<td><p>Número(s) da(s) linha(s) a ser(em) usada(s) como nome das colunas. Padrão é ‘infer’ (inferir a partir da primeira linha).</p></td>
</tr>
<tr class="row-even"><td><p>names</p></td>
<td><p>Lista de nomes de colunas a serem usadas. Se o arquivo já tiver um cabeçalho, você deverá especificar header=0 para substituir.</p></td>
</tr>
<tr class="row-odd"><td><p>index_col</p></td>
<td><p>Coluna(s) a ser(em) usada(s) como índice (linha).</p></td>
</tr>
<tr class="row-even"><td><p>usecols</p></td>
<td><p>Lista de colunas a serem lidas no DataFrame.</p></td>
</tr>
<tr class="row-odd"><td><p>dtype</p></td>
<td><p>Tipo de dado para colunas. Pode ser um único tipo ou um dicionário.</p></td>
</tr>
<tr class="row-even"><td><p>skiprows</p></td>
<td><p>Número de linhas ou sequência de índices de linha para pular ao ler.</p></td>
</tr>
<tr class="row-odd"><td><p>na_values</p></td>
<td><p>Sequência de valores que, se encontrados no CSV, devem ser tratados como NaN.</p></td>
</tr>
<tr class="row-even"><td><p>parse_dates</p></td>
<td><p>Colunas a serem interpretadas como datas.</p></td>
</tr>
<tr class="row-odd"><td><p>date_parser</p></td>
<td><p>Função a ser usada para analisar datas.</p></td>
</tr>
<tr class="row-even"><td><p>nrows</p></td>
<td><p>Número de linhas a serem lidas a partir do início do arquivo.</p></td>
</tr>
<tr class="row-odd"><td><p>skipfooter</p></td>
<td><p>Número de linhas a serem ignoradas na parte inferior do arquivo.</p></td>
</tr>
<tr class="row-even"><td><p>encoding</p></td>
<td><p>Codificação a ser usada para o arquivo. O padrão é ‘utf-8’, mas em alguns casos você pode precisar usar ‘ISO-8859-1’ ou outras.</p></td>
</tr>
<tr class="row-odd"><td><p>compression</p></td>
<td><p>Tipo de compressão do arquivo. Suporta ‘infer’, ‘gzip’, ‘bz2’, ‘zip’, ‘xz’, etc.</p></td>
</tr>
</tbody>
</table>
<p>Exemplo 2: Ler somente determinadas colunas de um arquivo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;~/geopythonbook/content/1_paises_america_sul/paises_america_sul.csv&#39;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;País&#39;</span><span class="p">,</span> <span class="s1">&#39;Área&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>País</th>
      <th>Área</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Argentina</td>
      <td>2780400</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bolívia</td>
      <td>1098581</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Brasil</td>
      <td>8515767</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Chile</td>
      <td>756102</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Colômbia</td>
      <td>1141748</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Exemplo 3: Ler um arquivo e interpretar a coluna ‘data’ como data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;~/geopythonbook/content/1_paises_america_sul/paises_america_sul.csv&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Independência&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>País                     object
População                 int64
Área                      int64
Independência    datetime64[ns]
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Exemplo 4: Tratar valores específicos como NaN.</p>
<p>Considere a tabela abaixo, que é proveniente de um arquivo CSV:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>País</p></th>
<th class="head"><p>População</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Brasil</p></td>
<td><p>211050000</p></td>
</tr>
<tr class="row-odd"><td><p>Argentina</p></td>
<td><p>NA</p></td>
</tr>
<tr class="row-even"><td><p>Chile</p></td>
<td><p>19116201</p></td>
</tr>
<tr class="row-odd"><td><p>Uruguai</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p>Paraguai</p></td>
<td><p>7044636</p></td>
</tr>
<tr class="row-odd"><td><p>Bolívia</p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
<p>Nesta tabela, temos diversos dados ausentes, representados por diferentes valores. Para que o Pandas os interprete como valores ausentes, podemos utilizar o método na_values() quando da leitura do arquivo CSV:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;~/geopythonbook/content/1_paises_america_sul/paises_america_sul.csv&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NA&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">],</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>O parâmetro na_values é usado para especificar uma lista de valores que devem ser tratados como “faltantes” (ou “NA” - Not Available) ao ler o arquivo. No exemplo fornecido, qualquer ocorrência dos valores ‘NA’, ‘N/A’ ou ‘-’ nas células do arquivo CSV será interpretada pelo Pandas como um valor faltante (NaN).</p>
<p>No caso do DataFrame de nosso exemplo, para ler os dados da coluna ‘População’ como int ao invés de float, você pode usar o argumento dtype do método read_CSV(). No entanto, é importante lembrar que os valores NaN são representados como float em Pandas. Portanto, se você tentar ler a coluna diretamente como int, receberá um erro quando encontrar um NaN. Uma solução seria ler a coluna como float primeiro (devido aos NaNs) e depois converter os valores não-NaN para int.</p>
</section>
<section id="arquivos-do-excel">
<h3>3.3.2 Arquivos do Excel<a class="headerlink" href="#arquivos-do-excel" title="Permalink to this heading">#</a></h3>
<p>A leitura de arquivos Excel é outra tarefa muito frequente em Geoprocessamento. O Pandas oferece suporte para ler dados de planilhas do Excel, tanto no formato .xls (formato mais antigo) quanto no .xlsx (formato mais recente). A função principal para essa tarefa é a read_excel.</p>
<p>Quadro 7: Parâmetros do método read_excel.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Parâmetro</p></th>
<th class="head"><p>Descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>io</p></td>
<td><p>Caminho do arquivo, URL ou objeto semelhante a um arquivo.</p></td>
</tr>
<tr class="row-odd"><td><p>sheet_name</p></td>
<td><p>Nome ou índice da planilha a ser lida. Padrão é a primeira. Pode ser também uma lista de nomes/índices ou None para todas.</p></td>
</tr>
<tr class="row-even"><td><p>header</p></td>
<td><p>Número da linha a ser usada como cabeçalho. Padrão é 0 (a primeira linha).</p></td>
</tr>
<tr class="row-odd"><td><p>names</p></td>
<td><p>Lista de nomes de colunas a serem usadas.</p></td>
</tr>
<tr class="row-even"><td><p>index_col</p></td>
<td><p>Coluna(s) a ser(em) usada(s) como índice (linha).</p></td>
</tr>
<tr class="row-odd"><td><p>usecols</p></td>
<td><p>Lista de colunas a serem lidas no DataFrame ou string no formato do Excel (por exemplo, “A,E:G”).</p></td>
</tr>
<tr class="row-even"><td><p>dtype</p></td>
<td><p>Tipo de dado para colunas. Pode ser um único tipo ou um dicionário.</p></td>
</tr>
<tr class="row-odd"><td><p>na_values</p></td>
<td><p>Sequência de valores que, se encontrados, devem ser tratados como NaN.</p></td>
</tr>
<tr class="row-even"><td><p>parse_dates</p></td>
<td><p>Colunas a serem interpretadas como datas.</p></td>
</tr>
<tr class="row-odd"><td><p>date_parser</p></td>
<td><p>Função a ser usada para analisar datas.</p></td>
</tr>
<tr class="row-even"><td><p>nrows</p></td>
<td><p>Número de linhas a serem lidas a partir do início da planilha.</p></td>
</tr>
<tr class="row-odd"><td><p>skipfooter</p></td>
<td><p>Número de linhas a serem ignoradas na parte inferior da planilha.</p></td>
</tr>
<tr class="row-even"><td><p>engine</p></td>
<td><p>Engine a ser usada para leitura. Pode ser ‘xlrd’, ‘openpyxl’ ou ‘odf’. Selecionada automaticamente pelo Pandas.</p></td>
</tr>
</tbody>
</table>
<p>Sintaxe básica:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;caminho_do_arquivo.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Exemplos:
Considere um arquivo do Excel denominado paises_america_sul_central, com duas planilhas (figura 4): américa_central e américa_sul.</p>
<p><img alt="Figura 4" src="_images/fig4.png" /></p>
<p>Figura 4: Planilhas do excel com dados de países das Américas do Sul e Central.</p>
<p>Para importar os dados somente da planilha america_central:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;~/geopythonbook/content/2_paises_america_sul_central/paises_america_sul_central.xlsx&#39;</span><span class="p">,</span> 
    <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;america_central&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>O método pd.read_excel() é utilizado para ler arquivos no formato Excel. O argumento adicional sheet_name=’america_central’ do método pd.read_excel() especifica qual planilha do arquivo Excel deve ser lida. Neste caso, estamos lendo a aba com o nome ‘america_central’.</p>
<p>Também é possível ler várias planilhas de um arquivo Excel com apenas um script:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;~/geopythonbook/content/2_paises_america_sul_central/paises_america_sul_central.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;america_sul&#39;</span><span class="p">,</span> <span class="s1">&#39;america_central&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Nesse código:</p>
<p><code class="docutils literal notranslate"><span class="pre">sheet_name=['america_sul',</span> <span class="pre">'america_central']</span> </code> especifica duas abas por meio de uma lista. Isso indica ao método pd.read_excel() que desejamos ler os dados de ambas as abas ‘america_sul’ e ‘america_central’. Como resultado, a variável dfs será um dicionário onde as chaves são os nomes das abas (‘america_sul’ e ‘america_central’) e os valores são os respectivos DataFrames com os dados de cada aba.</p>
</section>
<section id="gravacao-de-dados-em-diferentes-formatos">
<h3>3.3.3 Gravação de dados em diferentes formatos<a class="headerlink" href="#gravacao-de-dados-em-diferentes-formatos" title="Permalink to this heading">#</a></h3>
<p>O Pandas oferece uma série de métodos que permitem gravar DataFrames em diversos formatos. Vamos ver como salvar seus dados em formato .CSV e .xlsx.</p>
<p>Arquivo CSV</p>
<p>Para gravar um DataFrame como um arquivo CSV, use o método to_CSV:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;caminho_para_salvar.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Parâmetros comuns:</p>
<p>index: Se verdadeiro, inclui o índice do DataFrame no arquivo. Por padrão é True;
sep: Delimitador a ser usado. Por padrão é ‘,’.</p>
<p>Arquivo Excel</p>
<p>Para gravar um DataFrame em um arquivo do Excel, use o método to_excel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;caminho_para_salvar.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Planilha1&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Parâmetros comuns:</p>
<p>sheet_name: Nome da planilha onde os dados serão escritos. Por padrão é Sheet’;
index: Se verdadeiro, inclui o índice do DataFrame na planilha.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="capitulo2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2. FUNDAMENTOS DA LINGUAGEM PYTHON</p>
      </div>
    </a>
    <a class="right-next"
       href="capitulo4.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">4. GEOPROCESSAMENTO BÁSICO COM SHAPELY E FIONA</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducao-e-configuracoes-basicas">3.1 Introdução e Configurações Básicas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuracoes-iniciais">3.1.1 Configurações iniciais</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introducao-as-estruturas-de-dados-no-pandas">3.1.2 Introdução às estruturas de dados no Pandas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#criacao-e-manipulacao-de-series">3.1.3 Criação e manipulação de Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#criacao-de-dataframes">3.1.4 Criação de DataFrames</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulacao-e-selecao-de-dados">3.2 Manipulação e Seleção de Dados</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecao-e-filtragem-em-dataframes">3.2.1 Seleção e filtragem em DataFrames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulacao-de-dados-em-dataframes">3.2.2 Manipulação de Dados em DataFrames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulacao-de-indices">3.2.3 Manipulação de índices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operacoes-aritmeticas-com-dataframes">3.2.4 Operações aritméticas com DataFrames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tratamento-de-dados-ausentes-ou-faltantes">3.2.5 Tratamento de dados ausentes ou faltantes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agrupamento-e-agregacao-de-dados">3.2.6 Agrupamento e Agregação de Dados</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importacao-e-exportacao-de-dados">3.3 Importação e exportação de dados</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arquivos-csv-comma-separated-values">3.3.1 Arquivos CSV (Comma-Separated Values)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arquivos-do-excel">3.3.2 Arquivos do Excel</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gravacao-de-dados-em-diferentes-formatos">3.3.3 Gravação de dados em diferentes formatos</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alexandro Gularte Schafer
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>